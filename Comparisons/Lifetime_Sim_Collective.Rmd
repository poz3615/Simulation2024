 -  -  - 
title: "Collection of Tick Simulation"
author: "Piper Zimmerman"
date: "December 12, 2023"
output: pdf_document
 -  -  - 

```{r setup, include = FALSE}
knitr::opts_chunk$set(eval = FALSE)
library(ggplot2)
library(EnvStats)
```



```{r exp.topt.maxlife.boxplot}
double.box.df <- data.frame(
  Topt = c(df.new1[, 4], 
           df.new2[, 5], 
           df.new3[, 5], 
           df.new4[, 5], 
           df.new5[, 5], 
           23.3), 
  Lifetime = c(1/df.new1[, 1], 
               1/df.new2[, 1], 
               1/df.new3[, 1], 
               1/df.new4[, 1], 
               1/df.new5[, 1], 
               1/0.066), 
  Method = factor(c(rep("Individual Data", 938), rep("Mean Data", 938), rep("Individual Inverse Data", 938), 
               rep("Inverse of Mean Data", 938), rep("Mean of Inverse Data", 938), "True Curve")
               )
)

plot.x <- ggplot(double.box.df, aes(x =  Method, y =  Topt)) + 
  geom_boxplot()
plot.x <- layer_data(plot.x)[, 1:6]

plot.y <- ggplot(double.box.df, aes(x =  Method, y =  Lifetime)) + 
  geom_boxplot() 
plot.y <- layer_data(plot.y)[, 1:6]

dub <- double.box.df |> group_by(Method) |> summarise(medianTopt = median(Topt), 
                                                     medianLife = median(Lifetime), 
                                                     q1Topt = quantile(Topt, probs = 0.25), 
                                                     q3Topt = quantile(Topt, probs = 0.75), 
                                                     q1Life = quantile(Lifetime, probs = 0.25), 
                                                     q3Life = quantile(Lifetime, probs = 0.75)) |> 
  mutate(iqrTopt = q3Topt - q1Topt, 
         iqrLife = q3Life - q1Life, 
         maxTopt = q3Topt + 1.5 * iqrTopt, 
         minTopt = ifelse(q1Topt - 1.5 * iqrTopt < 0, 0, q1Topt - 1.5 * iqrTopt), 
         maxLife = q3Life + 1.5 * iqrLife, 
         minLife = q1Life - 1.5 * iqrLife, 
         Middle.Topt = plot.x$middle, 
         Middle.Life = plot.y$middle)

dub[3, 13] <- 0

dub$Method <- factor(dub$Method, levels = c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

medianTopt.True <- as.numeric(rep(dub[6, 2], 5))
medianLife.True <- as.numeric(rep(dub[6, 3], 5))

colnames(plot.x) <- paste0("x.", gsub("y", "", colnames(plot.x)))
colnames(plot.y) <- paste0("y.", gsub("y", "", colnames(plot.y)))
df <- cbind(plot.x, plot.y)
df$Method <- factor(c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

ggplot(data = dub[1:5, ], aes(fill = Method, color = Method))  + 
  scale_color_manual(values = viridis(5)) + 
  scale_fill_manual(values = viridis(5)) + 
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), 
            color = "black", fill = NA)  + 
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), alpha = 0.3)  + 
  geom_segment(aes(x = minTopt, y = plot.y$y.middle[1:5], xend = maxTopt, yend = plot.y$y.middle[1:5])) + #whiskers
  geom_segment(aes(x = minTopt, y = q1Life, xend = minTopt, yend = q3Life)) + #lower end
  geom_segment(aes(x = maxTopt, y = q1Life, xend = maxTopt, yend = q3Life)) + #upper end
  geom_segment(aes(x = plot.x$x.middle[1:5], y = minLife, xend = plot.x$x.middle[1:5], yend = maxLife)) + #whiskers
  geom_segment(aes(x = q1Topt, y = minLife, xend = q3Topt, yend = minLife)) + #lower end
  geom_segment(aes(x = q1Topt, y = maxLife, xend = q3Topt, yend = maxLife)) + #upper end
  theme_classic() + 
  #facet_wrap(dub$Method[1:5], nrow = 2, scales = "free") + 
  geom_point(aes(x = medianTopt.True, y =  medianLife.True), color = "black", show.legend = FALSE) + 
  geom_vline(aes(xintercept = medianTopt.True), color = "black", linetype = "dashed") +
  geom_hline(aes(yintercept = medianLife.True), color = "black", linetype = "dashed") +
  #theme(legend.position = "none") + 
  labs(x = "Optimal Temperature", 
       y = "Maximum Lifetime") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  )  
ggsave("Topt_Life_Exp.png", width = 6.5, height = 4)


double.box.df$Method <- factor(double.box.df$Method, levels = rev(c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve")))

box.topt.exp <- double.box.df %>%
  filter(Method != "True Curve") %>%
  group_by(Method) %>%
  summarize(
    median = median(Topt),
    lower_50 = hdi(Topt, credMass = 0.50)[1],
    upper_50 = hdi(Topt, credMass = 0.50)[2],
    lower_75 = hdi(Topt, credMass = 0.75)[1],
    upper_75 = hdi(Topt, credMass = 0.75)[2],
    lower_95 = hdi(Topt, credMass = 0.95)[1],
    upper_95 = hdi(Topt, credMass = 0.95)[2],
    .groups = "drop"
  )
box.topt.exp <- box.topt.exp |> 
  pivot_longer(
    cols = c(lower_95, upper_95, lower_75, upper_75, lower_50, upper_50),
    names_to = c("Bound", "Interval"),
    names_pattern = "(lower|upper)_(.*)",
    values_to = "Value") |> 
  pivot_wider(
    names_from = Bound,
    values_from = Value)  |> 
  mutate(
    Interval = factor(Interval, levels = c("95", "75", "50"),
                      labels = c("95% HDI", "75% HDI", "50% HDI")))
box.topt.exp$Method <- factor(box.topt.exp$Method, levels = rev(c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data")))
# Plot
ggplot(box.topt.exp, aes(y = Method, color = Interval)) +
  geom_linerange(aes(xmin = lower, xmax = upper, linewidth = Interval)) +
  geom_point(aes(x = median), size = 1.5, color = "black") +
  geom_vline(xintercept = 22.3, color = "black", linewidth = 1.25) +
  scale_color_viridis_d(
    name = "Interval"
  ) +
  scale_linewidth_manual(
    values = c("95% HDI" = 4, "75% HDI" = 6, "50% HDI" = 8),
    guide = "none"
  ) +
  guides(color = guide_legend(override.aes = list(linewidth = 3))) +
  theme_classic() +
  labs(x = "Optimal Temperature", 
       y = "Method") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "none",
  ) 
ggsave("Topt_Box.png", width = 6.5, height = 4)

# Compute medians + HDIs for lifetime plot
box.life.exp <- double.box.df %>%
  filter(Method != "True Curve") %>%
  group_by(Method) %>%
  summarize(
    median = median(Lifetime),
    lower_50 = hdi(Lifetime, credMass = 0.50)[1],
    upper_50 = hdi(Lifetime, credMass = 0.50)[2],
    lower_75 = hdi(Lifetime, credMass = 0.75)[1],
    upper_75 = hdi(Lifetime, credMass = 0.75)[2],
    lower_95 = hdi(Lifetime, credMass = 0.95)[1],
    upper_95 = hdi(Lifetime, credMass = 0.95)[2],
    .groups = "drop"
  )
box.life.exp <- box.life.exp |> 
  pivot_longer(
    cols = c(lower_95, upper_95, lower_75, upper_75, lower_50, upper_50),
    names_to = c("Bound", "Interval"),
    names_pattern = "(lower|upper)_(.*)",
    values_to = "Value") |> 
  pivot_wider(
    names_from = Bound,
    values_from = Value)  |> 
  mutate(
    Interval = factor(Interval, levels = c("95", "75", "50"),
                      labels = c("95% HDI", "75% HDI", "50% HDI")))
# Plot
ggplot(box.life.exp, aes(y = Method, color = Interval)) +
  geom_linerange(aes(xmin = lower, xmax = upper, linewidth = Interval)) +
  geom_point(aes(x = median), size = 1.5, color = "black") +
  geom_vline(xintercept = 15.15, color = "black", linewidth = 1.25) +
  scale_color_viridis_d(
    name = "Interval"
  ) +
  scale_linewidth_manual(
    values = c("95% HDI" = 4, "75% HDI" = 6, "50% HDI" = 8),
    guide = "none"
  ) +
  guides(color = guide_legend(override.aes = list(linewidth = 3))) +
  theme_classic() +
  labs(x = "Maximum Lifetime", 
       y = "Method") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12),
    axis.text.y = element_blank(),          # remove y-axis tick labels
    axis.title.y = element_blank() 
  ) 
ggsave("Life_Box.png", width = 4.5, height = 4)

box.topt.exp <- box.topt.exp |> mutate(length = upper - lower)
ref_lengths.topt <- box.topt.exp |> 
  filter(Method == "Individual Data") |> 
  select(Interval, ref_length = length)
box.topt.exp.times <- box.topt.exp |> 
  left_join(ref_lengths.topt, by = "Interval") |> 
  mutate(Times = length / ref_length) |> 
  select(Method, Interval, Times)

box.life.exp <- box.life.exp |> mutate(length = upper - lower)
ref_lengths.life <- box.life.exp |> 
  filter(Method == "Individual Data") |> 
  select(Interval, ref_length = length)
box.life.exp.times <- box.life.exp |> 
  left_join(ref_lengths.life, by = "Interval") |> 
  mutate(Times = length / ref_length) |> 
  select(Method, Interval, Times)


exp.topt.life.df <- rbind(exp.ind.uncertainty,
      exp.mean.uncertainty, exp.inv.uncertainty,
      exp.iom.uncertainty, exp.moi.uncertainty)
exp.topt.life.sum <- exp.topt.life.df |> group_by(Method) |> 
  summarise(topt.med = median(Length.Topt),
            life.med = median(1/Lower.life - 1/Upper.life)) |> 
  mutate(times.life = life.med/4.459901	,
         times.topt = topt.med/1.748454	)
  

```

```{r WB.topt.maxlife.boxplot}


double.box.df.wb <- data.frame(
  Topt = c(df.new6_W[, 5],
           df.new1_W[, 4], 
           df.new2_W[, 5], 
           df.new3_W[, 5], 
           df.new4_W[, 5], 
           df.new5_W[, 5], 
           22.3), 
  Lifetime = c(1/df.new6_W[, 1], 
               1/df.new1_W[, 1], 
               1/df.new2_W[, 1], 
               1/df.new3_W[, 1], 
               1/df.new4_W[, 1], 
               1/df.new5_W[, 1],
               15.15), 
  Method = factor(c( rep("Individual Data, WB", 938), rep("Individual Data, Exp", 938), rep("Mean Data", 938), rep("Individual Inverse Data", 938), 
               rep("Inverse of Mean Data", 938), rep("Mean of Inverse Data", 938), "True Curve"), 
               levels = c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", 
                "True Curve")
               )
)


plot.x.wb <- ggplot(double.box.df.wb, aes(x =  Method, y =  Topt)) + 
  geom_boxplot()
plot.x.wb <- layer_data(plot.x.wb)[, 1:6]

plot.y.wb <- ggplot(double.box.df.wb, aes(x =  Method, y =  Lifetime)) + 
  geom_boxplot() 
plot.y.wb <- layer_data(plot.y.wb)[, 1:6]

colnames(plot.x.wb) <- paste0("x.", gsub("y", "", colnames(plot.x.wb)))
colnames(plot.y.wb) <- paste0("y.", gsub("y", "", colnames(plot.y.wb)))
df.wb <- cbind(plot.x.wb, plot.y.wb)
df.wb$Method <- factor(c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", 
                "True Curve"))

dub.wb <- double.box.df.wb |> group_by(Method) |> summarise(medianTopt = median(Topt), 
                                                     medianLife = median(Lifetime), 
                                                     q1Topt = quantile(Topt, probs = 0.25), 
                                                     q3Topt = quantile(Topt, probs = 0.75), 
                                                     q1Life = quantile(Lifetime, probs = 0.25), 
                                                     q3Life = quantile(Lifetime, probs = 0.75)) |> 
  mutate(iqrTopt = q3Topt - q1Topt, 
         iqrLife = q3Life - q1Life, 
         maxTopt = q3Topt + 1.5 * iqrTopt, 
         minTopt = q1Topt - 1.5 * iqrTopt, 
         maxLife = q3Life + 1.5 * iqrLife, 
         minLife = q1Life - 1.5 * iqrLife, 
         Middle.Topt = plot.x.wb$middle, 
         Middle.Life = plot.y.wb$middle, )
dub.wb$Method <- factor(dub.wb$Method, levels = c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", 
                "True Curve"))
medianTopt.True.wb <- as.numeric(rep(dub.wb[7, 2], 6))
medianLife.True.wb <- as.numeric(rep(dub.wb[7, 3], 6))

plot.x.wb[6,3] <- (plot.x.wb[6,2] + plot.x.wb[6,4])/2
plot.x.wb[2,3] <- (plot.x.wb[2,2] + plot.x.wb[2,4])/2

dub.wb[4, 13] <- 0

ggplot(data = dub.wb[1:6, ], aes(fill = Method, color = Method))  + 
  scale_color_manual(values = plasma(6)) + 
  scale_fill_manual(values = plasma(6)) + 
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), 
            color = "black", fill = NA)  + 
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), alpha = 0.3)  + 
  geom_segment(aes(x = minTopt, y = plot.y.wb$y.middle[1:6], xend = maxTopt, yend = plot.y.wb$y.middle[1:6])) + #whiskers
  geom_segment(aes(x = minTopt, y = q1Life, xend = minTopt, yend = q3Life)) + #lower end
  geom_segment(aes(x = maxTopt, y = q1Life, xend = maxTopt, yend = q3Life)) + #upper end
  geom_segment(aes(x = plot.x.wb$x.middle[1:6], y = minLife, xend = plot.x.wb$x.middle[1:6], yend = maxLife)) + #whiskers
  geom_segment(aes(x = q1Topt, y = minLife, xend = q3Topt, yend = minLife)) + #lower end
  geom_segment(aes(x = q1Topt, y = maxLife, xend = q3Topt, yend = maxLife)) + #upper end
  theme_classic() + 
  geom_point(aes(x = medianTopt.True.wb, y =  medianLife.True.wb), color = "black", show.legend = FALSE) + 
  geom_vline(aes(xintercept = medianTopt.True.wb), color = "black", linetype = "dashed") +
  geom_hline(aes(yintercept = medianLife.True.wb), color = "black", linetype = "dashed") +
  #facet_wrap(dub.wb$Method[1:6], nrow = 2, scales = "free") + 
  #theme(legend.position = "none") + 
  labs(x = "Optimal Temperature", 
       y = "Maximum Lifetime") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) 
ggsave("Topt_Life_WB.png", width = 6.5, height = 4)


double.box.df.wb$Method <- factor(double.box.df.wb$Method, levels = rev(c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", 
                "True Curve")))

box.topt.wb <- double.box.df.wb %>%
  filter(Method != "True Curve") %>%
  group_by(Method) %>%
  summarize(
    median = median(Topt),
    lower_50 = hdi(Topt, credMass = 0.50)[1],
    upper_50 = hdi(Topt, credMass = 0.50)[2],
    lower_75 = hdi(Topt, credMass = 0.75)[1],
    upper_75 = hdi(Topt, credMass = 0.75)[2],
    lower_95 = hdi(Topt, credMass = 0.95)[1],
    upper_95 = hdi(Topt, credMass = 0.95)[2],
    .groups = "drop"
  )
box.topt.wb <- box.topt.wb |> 
  pivot_longer(
    cols = c(lower_95, upper_95, lower_75, upper_75, lower_50, upper_50),
    names_to = c("Bound", "Interval"),
    names_pattern = "(lower|upper)_(.*)",
    values_to = "Value") |> 
  pivot_wider(
    names_from = Bound,
    values_from = Value)  |> 
  mutate(
    Interval = factor(Interval, levels = c("95", "75", "50"),
                      labels = c("95% HDI", "75% HDI", "50% HDI")))
box.topt.wb$Method <- factor(box.topt.wb$Method, levels = rev(c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", 
                "True Curve")))
# Plot
ggplot(box.topt.wb, aes(y = Method, color = Interval)) +
  geom_linerange(aes(xmin = lower, xmax = upper, linewidth = Interval)) +
  geom_point(aes(x = median), size = 1.5, color = "black") +
  geom_vline(xintercept = 22.3, color = "black", linewidth = 1.25) +
  scale_color_viridis_d(
    name = "Interval",
    option = "plasma"
  ) +
  scale_linewidth_manual(
    values = c("95% HDI" = 4, "75% HDI" = 6, "50% HDI" = 8),
    guide = "none"
  ) +
  guides(color = guide_legend(override.aes = list(linewidth = 3))) +
  theme_classic() +
  labs(x = "Optimal Temperature", 
       y = "Method") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "none",
  ) 
ggsave("Topt_Box_WB.png", width = 6.5, height = 4)


# Compute medians + HDIs for lifetime plot
box.life.wb <- double.box.df.wb %>%
  filter(Method != "True Curve") %>%
  group_by(Method) %>%
  summarize(
    median = median(Lifetime),
    lower_50 = hdi(Lifetime, credMass = 0.50)[1],
    upper_50 = hdi(Lifetime, credMass = 0.50)[2],
    lower_75 = hdi(Lifetime, credMass = 0.75)[1],
    upper_75 = hdi(Lifetime, credMass = 0.75)[2],
    lower_95 = hdi(Lifetime, credMass = 0.95)[1],
    upper_95 = hdi(Lifetime, credMass = 0.95)[2],
    .groups = "drop"
  )
box.life.wb <- box.life.wb |> 
  pivot_longer(
    cols = c(lower_95, upper_95, lower_75, upper_75, lower_50, upper_50),
    names_to = c("Bound", "Interval"),
    names_pattern = "(lower|upper)_(.*)",
    values_to = "Value") |> 
  pivot_wider(
    names_from = Bound,
    values_from = Value)  |> 
  mutate(
    Interval = factor(Interval, levels = c("95", "75", "50"),
                      labels = c("95% HDI", "75% HDI", "50% HDI")))
# Plot
ggplot(box.life.wb, aes(y = Method, color = Interval)) +
  geom_linerange(aes(xmin = lower, xmax = upper, linewidth = Interval)) +
  geom_point(aes(x = median), size = 1.5, color = "black") +
  geom_vline(xintercept = 15.15, color = "black", linewidth = 1.25) +
  scale_color_viridis_d(
    name = "Interval",
    option = "plasma"
  ) +
  scale_linewidth_manual(
    values = c("95% HDI" = 4, "75% HDI" = 6, "50% HDI" = 8),
    guide = "none"
  ) +
  guides(color = guide_legend(override.aes = list(linewidth = 3))) +
  theme_classic() +
  labs(x = "Maximum Lifetime", 
       y = "Method") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12),
    axis.text.y = element_blank(),          # remove y-axis tick labels
    axis.title.y = element_blank() 
  ) 
ggsave("Life_Box_WB.png", width = 4.5, height = 4)

box.topt.wb <- box.topt.wb |> mutate(length = upper - lower)
ref_lengths.topt.wb <- box.topt.wb |> 
  filter(Method == "Individual Data, WB") |> 
  select(Interval, ref_length = length)
box.topt.wb.times <- box.topt.wb |> 
  left_join(ref_lengths.topt.wb, by = "Interval") |> 
  mutate(Times = length / ref_length) |> 
  select(Method, Interval, Times)

box.life.wb <- box.life.wb |> mutate(length = upper - lower)
ref_lengths.life.wb <- box.life.wb |> 
  filter(Method == "Individual Data, WB") |> 
  select(Interval, ref_length = length)
box.life.wb.times <- box.life.wb |> 
  left_join(ref_lengths.life.wb, by = "Interval") |> 
  mutate(Times = length / ref_length) |> 
  select(Method, Interval, Times)




wb.ind.uncertainty$Method <- "Individual Data, Exp"
wb.topt.life.df <- rbind(wb.ind.wb.uncertainty, wb.ind.uncertainty,
      wb.mean.uncertainty, wb.inv.uncertainty,
      wb.iom.uncertainty, wb.moi.uncertainty)
wb.topt.life.sum <- wb.topt.life.df |> group_by(Method) |> 
  summarise(topt.med = median(Length.Topt),
            life.med = median(1/Lower.life - 1/Upper.life)) |> 
  mutate(times.life = life.med/1.551115,
         times.topt = topt.med/0.5802045)

```



```{r exp.extreme.boxplot}

df_list <- list(df.new1, df.new2, df.new3, df.new4, df.new5)

# Lists to store results
x_values_list <- list()

# Loop through dataframes
for (df_index in 1:length(df_list)) {
  df <- df_list[[df_index]]
  x_values <- numeric()
  
  if (df_index  ==  1) {
    a_col <- 3
    b_col <- 4
    c_col <- 1
  } else {
    a_col <- 3
    b_col <- 5
    c_col <- 1
  }
  
  for (i in 1:nrow(df)) {
    a <- exp(df[i, a_col])
    b <- - 2 * (df[i, b_col]) * exp(df[i, a_col])
    c <- df[i, c_col] + exp(df[i, a_col]) * (df[i, b_col])^2
    
    # Solve quadratic equation for x when y = 1
    discriminant <- b^2 - 4 * a * (c - 1)
    if (discriminant >=  0) {
      x1 <- ( - b + sqrt(discriminant)) / (2 * a)
      x2 <- ( - b - sqrt(discriminant)) / (2 * a)
      x_values <- c(x_values, x1, x2)  
    } else {
      # If discriminant < 0, no real solutions
      warning("No real solutions for y = 1 in quadratic equation.")
    }
  }
  x_values_list[[length(x_values_list) + 1]] <- x_values  
}

double.box.df.ex <- data.frame(Low = numeric(), High = numeric())

# Loop through the list
for (i in seq_along(x_values_list)) {
  # Extract values from the list
  x_values <- x_values_list[[i]]
  
  # Create a dataframe with even indices as "low" and odd indices as "high"
  temp_df <- data.frame(High = x_values[c(TRUE, FALSE)], Low = x_values[c(FALSE, TRUE)])
  
  # Bind the dataframe to the result dataframe
  double.box.df.ex <- rbind(double.box.df.ex, temp_df)
}
double.box.df.ex <- rbind(double.box.df.ex, data.frame(Low = -6.935, 	 High = 51.542))

double.box.df.ex$Method <- factor(c(rep("Individual Data", 938), rep("Mean Data", 938), rep("Individual Inverse Data", 938), 
               rep("Inverse of Mean Data", 938), rep("Mean of Inverse Data", 938) , "True Curve")
)



plot.x.ex <- ggplot(double.box.df.ex, aes(x =  Method, y =  Low)) + 
  geom_boxplot()
plot.x.ex <- layer_data(plot.x.ex)[, 1:6]

plot.y.ex <- ggplot(double.box.df.ex, aes(x =  Method, y =  High)) + 
  geom_boxplot() 
plot.y.ex <- layer_data(plot.y.ex)[, 1:6]

dub.ex <- double.box.df.ex |> group_by(Method) |> summarise(medianLow = median(Low), 
                                                     medianHigh = median(High), 
                                                     q1Low = quantile(Low, probs = 0.25), 
                                                     q3Low = quantile(Low, probs = 0.75), 
                                                     q1High = quantile(High, probs = 0.25), 
                                                     q3High = quantile(High, probs = 0.75)) |> 
  mutate(iqrLow = q3Low - q1Low, 
         iqrHigh = q3High - q1High, 
         maxLow = q3Low + 1.5 * iqrLow, 
         minLow = q1Low - 1.5 * iqrLow, 
         maxHigh = q3High + 1.5 * iqrHigh, 
         minHigh = q3High - 1.5 * iqrHigh, 
         Middle.Low = plot.x.ex$middle, 
         Middle.High = plot.y.ex$middle)

dub.ex$Method <- factor(dub.ex$Method, levels = c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

medianLow.True.ex <- as.numeric(rep(dub.ex[6, 2], 5))
medianHigh.True.ex <- as.numeric(rep(dub.ex[6, 3], 5))

colnames(plot.x.ex) <- paste0("x.", gsub("y", "", colnames(plot.x.ex)))
colnames(plot.y.ex) <- paste0("y.", gsub("y", "", colnames(plot.y.ex)))
df.ex <- cbind(plot.x.ex, plot.y.ex)
df.ex$Method <- factor(c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

ggplot(data = dub.ex[1:5, ], aes(fill = Method, color = Method))  + 
  scale_fill_manual(values = viridis(5)) + 
  scale_color_manual(values = viridis(5)) + 
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), 
            color = "black", fill = NA)  +
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), alpha = 0.3)  + 
  geom_segment(aes(x = minLow, y = plot.y.ex$y.middle[1:5], xend = maxLow, yend = plot.y.ex$y.middle[1:5])) + #whiskers
  geom_segment(aes(x = minLow, y = q1High, xend = minLow, yend = q3High)) + #lower end
  geom_segment(aes(x = maxLow, y = q1High, xend = maxLow, yend = q3High)) + #upper end
  geom_segment(aes(x = plot.x.ex$x.middle[1:5], y = minHigh, xend = plot.x.ex$x.middle[1:5], yend = maxHigh)) + #whiskers
  geom_segment(aes(x = q1Low, y = minHigh, xend = q3Low, yend = minHigh)) + #lower end
  geom_segment(aes(x = q1Low, y = maxHigh, xend = q3Low, yend = maxHigh)) + #upper end
  theme_classic() + 
  #facet_wrap(dub.ex$Method[1:5], nrow = 2, scales = "free") + 
  geom_point(aes(x = medianLow.True.ex, y =  medianHigh.True.ex), color = "black", show.legend = FALSE) + 
  geom_vline(aes(xintercept = medianLow.True.ex), color = "black", linetype = "dashed") +
  geom_hline(aes(yintercept = medianHigh.True.ex), color = "black", linetype = "dashed") +
  #theme(legend.position = "none") + 
  labs(x = "T Lower", 
       y = "T Upper") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) 
ggsave("Ex_Temp_Exp.png", width = 6.5, height = 4)


dub.ex.iqr <- dub.ex[1:5, ] |>
  mutate(Range.Low = maxLow - minLow,
         Range.High = maxHigh - minHigh)

# Step 2: Get reference IQR for "Individual Data"
ref_range.low <- dub.ex.iqr$Range.Low[dub.ex.iqr$Method == "Individual Data"]
ref_range.high <- dub.ex.iqr$Range.High[dub.ex.iqr$Method == "Individual Data"]

# Step 3: Add times column
dub.ex.iqr <- dub.ex.iqr |>
  mutate(Times.Low = Range.Low / ref_range.low,
         Times.High = Range.High / ref_range.high)
dub.ex.iqr <- dub.ex.iqr[, c("Method", "Range.Low", "Range.High",
               "Times.Low", "Times.High")]

exp.ex.df <- rbind(exp.ind.whisk,
      exp.mean.whisk, exp.inv.whisk,
      exp.iom.whisk, exp.moi.whisk) |> na.omit()
exp.ex.sum <- exp.ex.df |> group_by(Method) |> 
  summarise(low.med = median(Range.Low),
            high.med = median(Range.High)) |> 
  mutate(times.low = low.med/9.194343,
         times.high = high.med/9.851466)

save(exp.ex.df, exp.topt.life.df,
     file = "Exponential.Uncertainty.RData")

```

```{r WB.extreme.boxplot}

df_list.wb <- list(df.new6_W, df.new1_W, df.new2_W, df.new3_W, df.new4_W, df.new5_W)

# Lists to store results
x_values_list.wb <- list()
    
# Loop through dataframes
for (df_index.wb in 1:length(df_list.wb)) {
  df <- df_list.wb[[df_index.wb]]
  x_values.wb <- numeric()
  
  if (df_index.wb  ==  2) {
    a_col <- 3
    b_col <- 4
    c_col <- 1
  } else {
    a_col <- 3
    b_col <- 5
    c_col <- 1
  }
  
  for (i in 1:nrow(df)) {
    a <- exp(df[i, a_col])
    b <- - 2 * (df[i, b_col]) * exp(df[i, a_col])
    c <- df[i, c_col] + exp(df[i, a_col]) * (df[i, b_col])^2
    
    # Solve quadratic equation for x when y = 1
    discriminant.wb <- b^2 - 4 * a * (c - 1)
    if (discriminant.wb >=  0) {
      x1.wb <- ( - b + sqrt(discriminant.wb)) / (2 * a)
      x2.wb <- ( - b - sqrt(discriminant.wb)) / (2 * a)
      x_values.wb <- c(x_values.wb, x1.wb, x2.wb)  
    } else {
      # If discriminant < 0, no real solutions
      warning("No real solutions for y = 1 in quadratic equation.")
    }
  }
  x_values_list.wb[[length(x_values_list.wb) + 1]] <- x_values.wb  
}

double.box.df.ex.wb <- data.frame(Low = numeric(), High = numeric())

# Loop through the list
for (i in seq_along(x_values_list.wb)) {
  # Extract values from the list
  x_values.wb <- x_values_list.wb[[i]]
  
  # Create a dataframe with even indices as "low" and odd indices as "high"
  temp_df.wb <- data.frame(High = x_values.wb[c(TRUE, FALSE)], Low = x_values.wb[c(FALSE, TRUE)])
  
  # Bind the dataframe to the result dataframe
  double.box.df.ex.wb <- rbind(double.box.df.ex.wb, temp_df.wb)
}
double.box.df.ex.wb <- rbind(double.box.df.ex.wb, data.frame(Low = -6.935, 	 High = 51.542))

double.box.df.ex.wb$Method <- factor(c(rep("Individual Data, WB", 938), rep("Individual Data, Exp", 938), rep("Mean Data", 938), rep("Individual Inverse Data", 938), 
               rep("Inverse of Mean Data", 938), rep("Mean of Inverse Data", 938), "True Curve" 
               ), 
               levels = c("Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "Individual Data, WB", "True Curve")
)



plot.x.ex.wb <- ggplot(double.box.df.ex.wb, aes(x =  Method, y =  Low)) + 
  geom_boxplot()
plot.x.ex.wb <- layer_data(plot.x.ex.wb)[, 1:18]

plot.y.ex.wb <- ggplot(double.box.df.ex.wb, aes(x =  Method, y =  High)) + 
  geom_boxplot() 
plot.y.ex.wb <- layer_data(plot.y.ex.wb)[, 1:18]

dub.ex.wb <- double.box.df.ex.wb |> group_by(Method) |> summarise(medianLow = median(Low), 
                                                     medianHigh = median(High), 
                                                     q1Low = quantile(Low, probs = 0.25), 
                                                     q3Low = quantile(Low, probs = 0.75), 
                                                     q1High = quantile(High, probs = 0.25), 
                                                     q3High = quantile(High, probs = 0.75)) |> 
  mutate(iqrLow = q3Low - q1Low, 
         iqrHigh = q3High - q1High, 
         maxLow = q3Low + 1.5 * iqrLow, 
         minLow = q1Low - 1.5 * iqrLow, 
         maxHigh = q3High + 1.5 * iqrHigh, 
         minHigh = q3High - 1.5 * iqrHigh, 
         Middle.Low = plot.x.ex.wb$middle, 
         Middle.High = plot.y.ex.wb$middle)

dub.ex.wb$Method <- factor(dub.ex.wb$Method, levels = c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

medianLow.True.ex.wb <- as.numeric(rep(dub.ex.wb[7, 2], 6))
medianHigh.True.ex.wb <- as.numeric(rep(dub.ex.wb[7, 3], 6))

colnames(plot.x.ex.wb) <- paste0("x.", gsub("y", "", colnames(plot.x.ex.wb)))
colnames(plot.y.ex.wb) <- paste0("y.", gsub("y", "", colnames(plot.y.ex.wb)))
df.ex.wb <- cbind(plot.x.ex.wb, plot.y.ex.wb)
df.ex.wb$Method <- factor(c("Individual Data, WB", "Individual Data, Exp", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data", "True Curve"))

ggplot(data = dub.ex.wb[1:6, ], aes(fill = Method, color = Method))  + 
  scale_fill_manual(values = plasma(6)) + 
  scale_color_manual(values = plasma(6)) + 
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), 
            color = "black", fill = NA)  + 
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), alpha = 0.3)  + 
  geom_segment(aes(x = minLow, y = plot.y.ex.wb$y.middle[1:6], xend = maxLow, yend = plot.y.ex.wb$y.middle[1:6])) + #whiskers
  geom_segment(aes(x = minLow, y = q1High, xend = minLow, yend = q3High)) + #lower end
  geom_segment(aes(x = maxLow, y = q1High, xend = maxLow, yend = q3High)) + #upper end
  geom_segment(aes(x = plot.x.ex.wb$x.middle[1:6], y = minHigh, xend = plot.x.ex.wb$x.middle[1:6], yend = maxHigh)) + #whiskers
  geom_segment(aes(x = q1Low, y = minHigh, xend = q3Low, yend = minHigh)) + #lower end
  geom_segment(aes(x = q1Low, y = maxHigh, xend = q3Low, yend = maxHigh)) + #upper end
  theme_classic() + 
  #facet_wrap(dub.ex.wb$Method[1:6], nrow = 2, scales = "free") + 
  geom_point(aes(x = medianLow.True.ex.wb, y =  medianHigh.True.ex.wb), color = "black", show.legend = FALSE) + 
  geom_vline(aes(xintercept = medianLow.True.ex.wb), color = "black", linetype = "dashed") +
  geom_hline(aes(yintercept = medianHigh.True.ex.wb), color = "black", linetype = "dashed") +
  #theme(legend.position = "none") + 
  labs(x = "T Lower", 
       y = "T Upper") + 
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 14),
    strip.text = element_text(size = 14),      # facet label size
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12)
  ) 
ggsave("Ex_Temp_WB.png", width = 6.5, height = 4)


dub.ex.iqr.wb <- dub.ex.wb[1:6, ] |>
  mutate(Range.Low = maxLow - minLow,
         Range.High = maxHigh - minHigh)

# Step 2: Get reference IQR for "Individual Data"
ref_range.low.wb <- dub.ex.iqr.wb$Range.Low[dub.ex.iqr.wb$Method == "Individual Data, WB"]
ref_range.high.wb <- dub.ex.iqr.wb$Range.High[dub.ex.iqr.wb$Method == "Individual Data, WB"]

# Step 3: Add times column
dub.ex.iqr.wb <- dub.ex.iqr.wb |>
  mutate(Times.Low = Range.Low / ref_range.low.wb,
         Times.High = Range.High / ref_range.high.wb)
dub.ex.iqr.wb <- dub.ex.iqr.wb[, c("Method", "Range.Low", "Range.High",
               "Times.Low", "Times.High")]

wb.ind.whisk$Method <- "Individual Data, Exp"
wb.ex.df <- rbind(wb.ind.wb.whisk, wb.ind.whisk,
      wb.mean.whisk, wb.inv.whisk,
      wb.iom.whisk, wb.moi.whisk) |> na.omit()
wb.ex.sum <- wb.ex.df |> group_by(Method) |> 
  summarise(low.med = median(Range.Low),
            high.med = median(Range.High)) |> 
  mutate(times.low = low.med/3.116566,
         times.high = high.med/3.327088)

save(wb.ex.df, wb.topt.life.df,
     file = "Weibull.Uncertainty.RData")
```



```{r QQPlot.Ind.Exp.Data}
ind.exp.10 <- qqPlot(data.list[[100]]$trait[data.list[[100]]$T == 10], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.exp.17 <- qqPlot(data.list[[100]]$trait[data.list[[100]]$T == 17], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.exp.21 <- qqPlot(data.list[[100]]$trait[data.list[[100]]$T == 21], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.exp.25 <- qqPlot(data.list[[100]]$trait[data.list[[100]]$T == 25], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.exp.32 <- qqPlot(data.list[[100]]$trait[data.list[[100]]$T == 32], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)
png(file="ind.exp.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(ind.exp.10, pch = 20, xlim = c(0, 80), ylim = c(0, 100), col = viridis(5)[1], 
       xlab = "Quantiles of Exponential Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.lab = 1.3,
     cex.axis = 1.3)
points(ind.exp.17, pch = 20, col =  viridis(5)[2])
points(ind.exp.21, pch = 20, col =  viridis(5)[3])
points(ind.exp.25, pch = 20, col =  viridis(5)[4])
points(ind.exp.32, pch = 20, col =  viridis(5)[5])
legend("topleft", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Mean.Exp.Data}
group_means.mean.exp <- tapply(data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp)  # Extract means and unlist the result
    )

mean.exp.10 <- qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)
mean.exp.17 <- qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.exp.21 <- qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.exp.25 <- qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.exp.32 <- qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="mean.exp.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(mean.exp.10, pch = 20, xlim = c(0, 1), ylim = c(0, 50), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.lab = 1.3,
     cex.axis = 1.3)
points(mean.exp.17, pch = 20, col =  viridis(5)[2])
points(mean.exp.21, pch = 20, col =  viridis(5)[3])
points(mean.exp.25, pch = 20, col =  viridis(5)[4])
points(mean.exp.32, pch = 20, col =  viridis(5)[5])
legend("topright", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]), 
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Inv.Exp.Data}
inv.exp.10 <- qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.exp.17 <- qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.exp.21 <- qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.exp.25 <- qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.exp.32 <- qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="inv.exp.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(inv.exp.10, pch = 20, col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal", 
       ylab = "Quantiles of Generated Data",
     cex.lab = 1.3,
     cex.axis = 1.3)
points(inv.exp.17, pch = 20, col =  viridis(5)[2])
points(inv.exp.21, pch = 20, col =  viridis(5)[3])
points(inv.exp.25, pch = 20, col =  viridis(5)[4])
points(inv.exp.32, pch = 20, col =  viridis(5)[5])
legend("topleft", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Mean.Inv.Exp.Data}
group_means.mean.exp <- tapply(data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp)  # Extract means and unlist the result
    )

mean.inv.exp.10 <- qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.exp.17 <- qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.exp.21 <- qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.exp.25 <- qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.exp.32 <- qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="mean.inv.exp.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(mean.inv.exp.10, pch = 20, xlim = c(0, 30), ylim = c(0, 0.75), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal", 
       ylab = "Quantiles of Generated Data",
     cex.lab = 1.3,
     cex.axis = 1.3)
points(mean.inv.exp.17, pch = 20, col =  viridis(5)[2])
points(mean.inv.exp.21, pch = 20, col =  viridis(5)[3])
points(mean.inv.exp.25, pch = 20, col =  viridis(5)[4])
points(mean.inv.exp.32, pch = 20, col =  viridis(5)[5])
legend("topleft", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Inv.Mean.Exp.Data}
group_means.inv.exp <- tapply(1/data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.exp)  # Extract means and unlist the result
    )

inv.mean.exp.10 <- qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.exp.17 <- qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.exp.21 <- qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.exp.25 <- qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.exp.32 <- qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))^2  + 
                               median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="inv.mean.exp.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(inv.mean.exp.10, pch = 20, xlim = c(0, 30), ylim = c(0, 5), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal", 
       ylab = "Quantiles of Generated Data",
     cex.lab = 1.3,
     cex.axis = 1.3)
points(inv.mean.exp.17, pch = 20, col =  viridis(5)[2])
points(inv.mean.exp.21, pch = 20, col =  viridis(5)[3])
points(inv.mean.exp.25, pch = 20, col =  viridis(5)[4])
points(inv.mean.exp.32, pch = 20, col =  viridis(5)[5])
legend("topright", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```



```{r QQPlot.Ind.WB.Data}
ind.wb.10 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 10], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.wb.17 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 17], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.wb.21 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 21], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.wb.25 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 25], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

ind.wb.32 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 32], 
       distribution = "exp", 
       param.list = list(rate = (exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2]))))), plot.it = FALSE)

png(file="ind.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(ind.wb.10, xlim = c(0, 40), ylim = c(0, 40), pch = 20, col = viridis(5)[1], 
       xlab = "Quantiles of Exponential Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(ind.wb.17, pch = 20, col =  viridis(5)[2])
points(ind.wb.21, pch = 20, col =  viridis(5)[3])
points(ind.wb.25, pch = 20, col =  viridis(5)[4])
points(ind.wb.32, pch = 20, col =  viridis(5)[5])
legend("topleft", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Mean.WB.Data}
group_means.mean.wb <- tapply(Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb)  # Extract means and unlist the result
    )

mean.wb.10 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.wb.17 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.wb.21 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.wb.25 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)
mean.wb.32 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list2[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)


png(file="mean.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(mean.wb.10, pch = 20, xlim = c(0, 2), ylim = c(0, 30), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(mean.wb.17, pch = 20, col = viridis(5)[2])
points(mean.wb.21, pch = 20, col =  viridis(5)[3])
points(mean.wb.25, pch = 20, col =  viridis(5)[4])
points(mean.wb.32, pch = 20, col =  viridis(5)[5])
legend("topright", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```

```{r QQPlot.Inv.WB.Data}
inv.wb.10 <- qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.wb.17 <- qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.wb.21 <- qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.wb.25 <- qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.wb.32 <- qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 32], 
       distribution = "normTrunc", 
        param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="inv.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(inv.wb.10, xlim = c(0, 30), ylim = c(0, 3), pch = 20, col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(inv.wb.17, pch = 20, col = viridis(5)[2])
points(inv.wb.21, pch = 20, col = viridis(5)[3])
points(inv.wb.25, pch = 20, col =  viridis(5)[4])
points(inv.wb.32, pch = 20, col =  viridis(5)[5])
legend("top", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()

```

```{r QQPlot.Mean.Inv.WB.Data}
group_means.mean.wb <- tapply(Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb)  # Extract means and unlist the result
    )

mean.inv.wb.10 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.wb.17 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.wb.21 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.wb.25 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

mean.inv.wb.32 <- qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="mean.inv.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(mean.inv.wb.10, pch = 20, ylim = c(0, 30), xlim = c(0, 175), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(mean.inv.wb.17, pch = 20, col =  viridis(5)[2])
points(mean.inv.wb.21, pch = 20, col =  viridis(5)[3])
points(mean.inv.wb.25, pch = 20, col =  viridis(5)[4])
points(mean.inv.wb.32, pch = 20, col =  viridis(5)[5])
legend("topright", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()

```

```{r QQPlot.Inv.Mean.WB.Data}
group_means.inv.wb <- tapply(1/Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.wb)  # Extract means and unlist the result
    )

inv.mean.wb.10 <- qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T == 10], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.wb.17 <- qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T == 17], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.wb.21 <- qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T == 21], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.wb.25 <- qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T == 25], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

inv.mean.wb.32 <- qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T == 32], 
       distribution = "normTrunc", 
       param.list = list(mean = (exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))), 
                       sd = 1/median(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 2]))), 
                       min = 0, 
                       max = Inf), 
       plot.it = FALSE)

png(file="inv.mean.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(inv.mean.wb.10, pch = 20, xlim = c(0, 60), ylim = c(0, 2), col = viridis(5)[1], 
       xlab = "Quantiles of Truncated Normal Distributions", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(inv.mean.wb.17, pch = 20, col =  viridis(5)[2])
points(inv.mean.wb.21, pch = 20, col =  viridis(5)[3])
points(inv.mean.wb.25, pch = 20, col =  viridis(5)[4])
points(inv.mean.wb.32, pch = 20, col =  viridis(5)[5])
legend("topright", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()

```

```{r QQPlot.WB.Data.WB.Model}
wb.wb.10 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 10], 
       distribution = "weibull", 
       param.list = list(scale = 1/(exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2])))) * (10 - 
                               (median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2]))))/log(2)^(1/median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), 
                         shape = median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), plot.it = FALSE)

wb.wb.17 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 17], 
       distribution = "weibull", 
       param.list = list(scale = 1/(exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2])))) * (17 - 
                               (median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2]))))/log(2)^(1/median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), 
                         shape = median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), plot.it = FALSE)

wb.wb.21 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 21], 
       distribution = "weibull", 
       param.list = list(scale = 1/(exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2])))) * (21 - 
                               (median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2]))))/log(2)^(1/median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))),
                         shape = median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), plot.it = FALSE)

wb.wb.25 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 25], 
       distribution = "weibull", 
       param.list = list(scale = 1/(exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2])))) * (25 - 
                               (median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2]))))/log(2)^(1/median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), 
                         shape = median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), plot.it = FALSE)

wb.wb.32 <- qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T == 32], 
       distribution = "weibull", 
       param.list = list(scale = 1/(exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2])))) * (32 - 
                               (median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))))^2  + 
                               median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2]))))/log(2)^(1/median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), 
                         shape = median(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 2])))), plot.it = FALSE)


png(file="ind.wb.wb.qq.png",
    width = 7, height = 6, units = "in", res = 250)
plot(wb.wb.10, xlim = c(0, 40), ylim = c(0, 35), pch = 20, col = viridis(5)[1], 
       xlab = "Quantiles of Weibull Distribution", 
       ylab = "Quantiles of Generated Data",
     cex.axis = 1.3,
     cex.lab = 1.3)
points(wb.wb.17, pch = 20, col = viridis(5)[2])
points(wb.wb.21, pch = 20, col = viridis(5)[3])
points(wb.wb.25, pch = 20, col = viridis(5)[4])
points(wb.wb.32, pch = 20, col = viridis(5)[5])
legend("topleft", legend = c("10", "17", "21", "25", "32"), 
       pch = c(20, 20, 20, 20, 20), col = c(viridis(5)[1], viridis(5)[2], viridis(5)[3], viridis(5)[4], viridis(5)[5]),
       cex = 1.5)
abline(a = 0, b = 1, lwd = 2, col = "black")
dev.off()
```



```{r RMSE.range.exp}
rmse.range.df <- data.frame(
  Method = factor(c("Individual Data", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data")), 
  Lower.RMSE = c(range(rmse.range.ind)[1],
                   range(rmse.range.mean)[1],
                   range(rmse.range.inv)[1],
                   range(rmse.range.mean.inv)[1],
                   range(rmse.range.inv.mean)[1]),
  Upper.RMSE = c(range(rmse.range.ind)[2],
                   range(rmse.range.mean)[2],
                   range(rmse.range.inv)[2],
                   range(rmse.range.mean.inv)[2],
                   range(rmse.range.inv.mean)[2]),
  Average.RMSE = c(mean(rmse.range.ind),
                   mean(rmse.range.mean),
                   mean(rmse.range.inv),
                   mean(rmse.range.mean.inv),
                   mean(rmse.range.inv.mean)),
  Upper.95 = c(hdi(rmse.range.ind)[2],
                   hdi(rmse.range.mean)[2],
                   hdi(rmse.range.inv)[2],
                   hdi(rmse.range.mean.inv)[2],
                   hdi(rmse.range.inv.mean)[2]),
  Lower.95 = c(hdi(rmse.range.ind)[1],
                   hdi(rmse.range.mean)[1],
                   hdi(rmse.range.inv)[1],
                   hdi(rmse.range.mean.inv)[1],
                   hdi(rmse.range.inv.mean)[1])
)

rmse.range.df$Method <- factor(rmse.range.df$Method, levels = desired_order)
rmse.range.df |> ggplot(aes(x = Method)) +
  geom_linerange(aes(ymin = log(Lower.95), ymax = log(Upper.95), x = Method)) +
  geom_point(aes(y = log(Lower.95), color = "Lower HDI")) +
  geom_point(aes(y = log(Upper.95), color = "Upper HDI")) +
  geom_point(aes(y = log(Average.RMSE), color = "Average RMSE")) +
  scale_color_manual(
  values = c(
    "Lower HDI" = viridis(5)[4],
    "Average RMSE" = viridis(5)[3],
    "Upper HDI" = viridis(5)[2]
  ),
  breaks = c("Lower HDI", "Average RMSE", "Upper HDI")
) +
  coord_flip() +
  labs(y = "Log of RMSE") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("rmse.range.exp.png", width = 8, height = 4)

rmse.range.df |> ggplot(aes(x = Method)) +
  geom_linerange(aes(ymin = Lower.RMSE, ymax = Upper.RMSE, x = Method)) +
  geom_point(aes(y = Lower.RMSE, color = "Lower RMSE")) +
  geom_point(aes(y = Upper.RMSE, color = "Upper RMSE")) +
  geom_point(aes(y = Average.RMSE, color = "Average RMSE")) +
  scale_color_manual(values = c("Lower RMSE" = viridis(3)[3], "Upper RMSE" = viridis(3)[1], "Average RMSE" = viridis(3)[2])) +
  coord_flip() +
  labs(y = "Log of RMSE", title = "Range of RMSE Over 100 Models") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
```

```{r RMSE.range.wb}
rmse.range.df.wb <- data.frame(
  Method = factor(c("Individual Data, WB Model", "Individual Data, Exp Model", "Mean Data", "Individual Inverse Data", 
               "Inverse of Mean Data", "Mean of Inverse Data")), 
  Lower.RMSE = c(range(rmse.range.ind.wb.wb)[1],
                 range(rmse.range.ind.wb)[1],
                   range(rmse.range.mean.wb)[1],
                   range(rmse.range.inv.wb)[1],
                   range(rmse.range.mean.inv.wb)[1],
                   range(rmse.range.inv.mean.wb)[1]),
  Upper.RMSE = c(range(rmse.range.ind.wb.wb)[2],
                 range(rmse.range.ind.wb)[2],
                   range(rmse.range.mean.wb)[2],
                   range(rmse.range.inv.wb)[2],
                   range(rmse.range.mean.inv.wb)[2],
                   range(rmse.range.inv.mean.wb)[2]),
  Average.RMSE = c(mean(rmse.range.ind.wb.wb),
                   mean(rmse.range.ind.wb),
                   mean(rmse.range.mean.wb),
                   mean(rmse.range.inv.wb),
                   mean(rmse.range.mean.inv.wb),
                   mean(rmse.range.inv.mean.wb)),
  Upper.95 = c(hdi(rmse.range.ind.wb.wb)[2],
                 hdi(rmse.range.ind.wb)[2],
                   hdi(rmse.range.mean.wb)[2],
                   hdi(rmse.range.inv.wb)[2],
                   hdi(rmse.range.mean.inv.wb)[2],
                   hdi(rmse.range.inv.mean.wb)[2]),
  Lower.95 = c(hdi(rmse.range.ind.wb.wb)[1],
                 hdi(rmse.range.ind.wb)[1],
                   hdi(rmse.range.mean.wb)[1],
                   hdi(rmse.range.inv.wb)[1],
                   hdi(rmse.range.mean.inv.wb)[1],
                   hdi(rmse.range.inv.mean.wb)[1])
)

rmse.range.df.wb$Method <- factor(rmse.range.df.wb$Method, levels = desired_order.wb)
rmse.range.df.wb |> ggplot(aes(x = Method)) +
  geom_linerange(aes(ymin = log(Lower.95), ymax = log(Upper.95), x = Method)) +
  geom_point(aes(y = log(Lower.95), color = "Lower HDI")) +
  geom_point(aes(y = log(Upper.95), color = "Upper HDI")) +
  geom_point(aes(y = log(Average.RMSE), color = "Average RMSE")) +
  scale_color_manual(
  values = c(
    "Lower HDI" = viridis(5)[4],
    "Average RMSE" = viridis(5)[3],
    "Upper HDI" = viridis(5)[2]
  ),
  breaks = c("Lower HDI", "Average RMSE", "Upper HDI")) +
  coord_flip() +
  labs(y = "Log of RMSE") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("rmse.range.wb.png", width = 8, height = 4)

rmse.range.df.wb |> ggplot(aes(x = Method)) +
  geom_linerange(aes(ymin = Lower.RMSE, ymax = Upper.RMSE, x = Method)) +
  geom_point(aes(y = Lower.RMSE, color = "Lower RMSE")) +
  geom_point(aes(y = Upper.RMSE, color = "Upper RMSE")) +
  geom_point(aes(y = Average.RMSE, color = "Average RMSE")) +
  scale_color_manual(values = c("Lower RMSE" = viridis(3)[3], "Upper RMSE" = viridis(3)[1], "Average RMSE" = viridis(3)[2])) +
  coord_flip() +
  labs(y = "Log of RMSE", title = "Range of RMSE Over 100 Models, Weibull Data") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
```

```{r RMSE.range.comp.exp}
rmse.range.comp.df <- rbind(rmse.range.df, rmse.range.df.n)
rmse.range.comp.df$Experiment <- as.factor(c(rep("Wide", 5), rep("Narrow", 5)))
rmse.range.comp.df |> ggplot(aes(x = Method, group = Experiment)) +
  geom_linerange(aes(ymin = log(Lower.95), ymax = log(Upper.95)), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Lower.95), color = "Lower HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Upper.95), color = "Upper HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Average.RMSE), color = "Average RMSE"), position = position_dodge(width = 0.75)) +
  geom_text(aes(y = log(Average.RMSE), label = Experiment), 
            position = position_dodge(width = 0.75), 
            vjust = -0.5, hjust = -0.2, size = 4) +
  scale_color_manual(
  values = c(
    "Lower HDI" = viridis(5)[4],
    "Average RMSE" = viridis(5)[3],
    "Upper HDI" = viridis(5)[2]
  ),
  breaks = c("Lower HDI", "Average RMSE", "Upper HDI")
) +
  coord_flip() +
  labs(y = "Log of RMSE") +
  theme_classic() +
  labs(color = " ")+
  theme(legend.position = "none") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("rmse.range.comp.exp.png", width = 8.5, height = 4)

rmse.range.comp.df |> ggplot(aes(x = Method, group = Experiment)) +
  geom_linerange(aes(ymin = Lower.RMSE, ymax = Upper.RMSE, x = Method), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = Lower.RMSE, color = "Lower RMSE"), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = Upper.RMSE, color = "Upper RMSE"), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = log(Lower.95), color = "Lower HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Upper.95), color = "Upper HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = Average.RMSE, color = "Average RMSE"), position = position_dodge(width = 0.5)) +
  geom_text(aes(y = Average.RMSE, label = Experiment), 
            position = position_dodge(width = 0.5), 
            vjust = -0.5, hjust = -0.2, size = 5) +
  scale_color_manual(
  values = c(
    "Lower RMSE" = viridis(5)[5],
    "Lower HDI" = viridis(5)[4],
    "Average RMSE" = viridis(5)[3],
    "Upper HDI" = viridis(5)[2],
    "Upper RMSE" = viridis(5)[1]
  ),
  breaks = c("Lower RMSE", "Lower HDI", "Average RMSE", "Upper HDI", "Upper RMSE")
) +
  coord_flip() +
  labs(y = "Log of RMSE", title = "Range of RMSE Over 100 Models, Exponential Data") +
  theme_classic() +
  labs(color = " ")+
  theme(legend.position = "none") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
```

```{r RMSE.range.comp.wb}
rmse.range.comp.wb.df <- rbind(rmse.range.df.wb, rmse.range.df.wb.n)
rmse.range.comp.wb.df$Experiment <- as.factor(c(rep("Wide", 6), rep("Narrow", 6)))
rmse.range.comp.wb.df |> ggplot(aes(x = Method, group = Experiment)) +
  geom_linerange(aes(ymin = log(Lower.95), ymax = log(Upper.95), x = Method), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Lower.95), color = "Lower HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Upper.95), color = "Upper HDI"), position = position_dodge(width = 0.75)) +
  geom_point(aes(y = log(Average.RMSE), color = "Average RMSE"), position = position_dodge(width = 0.75)) +
  geom_text(aes(y = log(Average.RMSE), label = Experiment), 
            position = position_dodge(width = 0.75), 
            vjust = -0.5, hjust = -0.2, size = 4) +
  scale_color_manual(
  values = c(
    "Lower HDI" = viridis(5)[4],
    "Average RMSE" = viridis(5)[3],
    "Upper HDI" = viridis(5)[2]
  ),
  breaks = c("Lower HDI", "Average RMSE", "Upper HDI")
) +
  coord_flip() +
  labs(y = "Log of RMSE") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("rmse.range.comp.wb.png", width = 9, height = 4)

rmse.range.comp.wb.df |> ggplot(aes(x = Method, group = Experiment)) +
  geom_linerange(aes(ymin = Lower.RMSE, ymax = Upper.RMSE, x = Method), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = Lower.RMSE, color = "Lower RMSE"), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = Upper.RMSE, color = "Upper RMSE"), position = position_dodge(width = 0.5)) +
  geom_point(aes(y = Average.RMSE, color = "Average RMSE"), position = position_dodge(width = 0.5)) +
  geom_text(aes(y = Average.RMSE, label = Experiment), 
            position = position_dodge(width = 0.5), 
            vjust = -0.5, hjust = -0.2, size = 3) +
  scale_color_manual(values = c("Lower RMSE" = viridis(3)[3], "Upper RMSE" = viridis(3)[1], "Average RMSE" = viridis(3)[2])) +
  coord_flip() +
  labs(y = "Log of RMSE", title = "Range of RMSE Over 100 Models, Weibull Data") +
  theme_classic() +
  labs(color = " ") +
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16), 
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
```



```{r n.w.compare.exp.mr}
exp.ind.mr <- ggplot()  + 
  geom_line(data = N_mean.xdf1, aes(x = point, y = med.value), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf1, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf1, aes(x = point, y = med.value), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf1, aes(x = point, y = true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.ind.mr.png", plot = exp.ind.mr, height = 5, width = 6)

exp.mean.mr <- ggplot()  + 
  geom_line(data = N_mean.xdf2, aes(x = point, y = med.value), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf2, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf2, aes(x = point, y = med.value), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf2, aes(x = point, y = true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate") + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.mean.mr.png", plot = exp.mean.mr, height = 5, width = 6)

exp.inv.mr <- ggplot()  + 
  geom_line(data = N_mean.xdf3, aes(x = point, y = med.value), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf3, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf3, aes(x = point, y = med.value), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf3, aes(x = point, y = true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.inv.mr.png", plot = exp.inv.mr, height = 5, width = 6)

exp.mean.inv.mr <- ggplot()  + 
  geom_line(data = N_mean.xdf4, aes(x = point, y = med.value), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf4, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf4, aes(x = point, y = med.value), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4, aes(ymin = lower.hdi, ymax = upper.hdi, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf4, aes(x = point, y = true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.mean.inv.mr.png", plot = exp.mean.inv.mr, height = 5, width = 6)

exp.inv.mean.mr <- ggplot()  + 
  geom_line(data = N_mean.xdf5, aes(x = point, y = med.value, color = "Narrow"), lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf5, aes(ymin = lower.hdi, ymax = upper.hdi, x = point, fill = "Narrow"), alpha = 0.3)  + 
  geom_line(data = mean.xdf5, aes(x = point, y = med.value, color = "Wide"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5, aes(ymin = lower.hdi, ymax = upper.hdi, x = point, fill = "Wide"), alpha = 0.2)  + 
  geom_line(data = mean.xdf5, aes(x = point, y = true_curve, color = "True Curve"), linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate", 
       fill = "95% HDI Bands", 
       color = "Posterior Curve")  + 
  scale_color_manual(values = c("Narrow" = cividis(10)[1], "Wide" = rocket(10)[5], "True Curve" = "black"))  + 
  scale_fill_manual(values = c("Narrow" = cividis(10)[1], "Wide" = rocket(10)[5]))  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.inv.mean.mr.png", plot = exp.inv.mean.mr, height = 5, width = 7)
```

```{r n.w.compare.exp.lt}
exp.ind.life <- ggplot()  + 
  geom_line(data = N_mean.xdf1, aes(x = point, y = med.value.inv), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf1, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf1, aes(x = point, y = med.value.inv), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf1, aes(x = point, y = 1/true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.ind.life.png", plot = exp.ind.life, height = 5, width = 6)

exp.mean.life <- ggplot()  + 
  geom_line(data = N_mean.xdf2, aes(x = point, y = med.value.inv), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf2, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf2, aes(x = point, y = med.value.inv), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf2, aes(x = point, y = 1/true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.mean.life.png", plot = exp.mean.life, height = 5, width = 6)

exp.inv.life <- ggplot()  + 
  geom_line(data = N_mean.xdf3, aes(x = point, y = med.value.inv), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf3, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf3, aes(x = point, y = med.value.inv), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf3, aes(x = point, y = 1/true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.inv.life.png", plot = exp.inv.life, height = 5, width = 6)

exp.mean.inv.life <- ggplot()  + 
  geom_line(data = N_mean.xdf4, aes(x = point, y = med.value.inv), color = cividis(10)[1], lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf4, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = cividis(10)[1], alpha = 0.3)  + 
  geom_line(data = mean.xdf4, aes(x = point, y = med.value.inv), color = rocket(10)[5], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point), fill = rocket(10)[5], alpha = 0.2)  + 
  geom_line(data = mean.xdf4, aes(x = point, y = 1/true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.mean.inv.life.png", plot = exp.mean.inv.life, height = 5, width = 6)

exp.inv.mean.life <- ggplot()  + 
  geom_line(data = N_mean.xdf5, aes(x = point, y = med.value.inv, color = "Narrow"), lwd = 1)  + 
  geom_ribbon(data = N_mean.xdf5, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point, fill = "Narrow"), alpha = 0.3)  + 
  geom_line(data = mean.xdf5, aes(x = point, y = med.value.inv, color = "Wide"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5, aes(ymin = lower.hdi.inv, ymax = upper.hdi.inv, x = point, fill = "Wide"), alpha = 0.2)  + 
  geom_line(data = mean.xdf5, aes(x = point, y = 1/true_curve, color = "True Curve"), linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime", 
       fill = "95% HDI Bands", 
       color = "Posterior Curve")  + 
  scale_color_manual(values = c("Narrow" = cividis(10)[1], "Wide" = rocket(10)[5], "True Curve" = "black"))  + 
  scale_fill_manual(values = c("Narrow" = cividis(10)[1], "Wide" = rocket(10)[5]))  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("exp.inv.mean.life.png", plot = exp.inv.mean.life, height = 5, width = 7)

```

```{r n.w.compare.wb.lt}
wb.ind.life <- ggplot()  + 
  geom_line(data =  mean.xdf1_W_N, aes(x = point, y = med.value.inv), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf1_W, aes(x = point, y = med.value.inv), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf1_W, aes(y = log(2)/true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.ind.life.png", plot = wb.ind.life, height = 5, width = 6.5)

wb.mean.life <- ggplot()  + 
  geom_line(data =  mean.xdf2_W_N, aes(x = point, y = med.value.inv), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf2_W, aes(x = point, y = med.value.inv), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf2_W, aes(y = log(2)/true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.mean.life.png", plot = wb.mean.life, height = 5, width = 6.5)

wb.inv.life <- ggplot()  + 
  geom_line(data =  mean.xdf3_W_N, aes(x = point, y = med.value.inv), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf3_W, aes(x = point, y = med.value.inv), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf3_W, aes(y = 1/true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.inv.life.png", plot = wb.inv.life, height = 5, width = 6.5)

wb.mean.inv.life <- ggplot()  + 
  geom_line(data =  mean.xdf4_W_N, aes(x = point, y = med.value.inv), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf4_W, aes(x = point, y = med.value.inv), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf4_W, aes(y = 1/true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.mean.inv.life.png", plot = wb.mean.inv.life, height = 5, width = 6.5)

wb.inv.mean.life <- ggplot()  + 
  geom_line(data =  mean.xdf5_W_N, aes(x = point, y = med.value.inv, color = "Narrow"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv, fill = "Narrow"), alpha = 0.3)  + 
  geom_line(data =  mean.xdf5_W, aes(x = point, y = med.value.inv, color = "Wide"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv, fill = "Wide"), alpha = 0.3)  + 
  geom_line(data = mean.xdf5_W, aes(x = point, y = 1/true_curve, color = "True Curve"), linetype = "dashed")  + 
    labs(x = "Temperature", 
       y = "Lifetime", 
       fill = "95% HDI Bands", 
       color = "Posterior Curve")  + 
  scale_color_manual(values = c("Narrow" = mako(10)[8], "Wide" = plasma(10)[8], "True Curve" = "black"))  + 
  scale_fill_manual(values = c("Narrow" = mako(10)[8], "Wide" = plasma(10)[8]))  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.inv.mean.life.png", plot = wb.inv.mean.life, height = 5, width = 7.5)

wb.wb.ind.life <- ggplot()  + 
  geom_line(data =  mean.xdf6_W_N, aes(x = point, y = med.value.inv), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W_N, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf6_W, aes(x = point, y = med.value.inv), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf6_W, aes(y = 1/true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Lifetime")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.wb.ind.life.png", plot = wb.wb.ind.life, height = 5, width = 6.5)
```

```{r n.w.compare.wb.mr}
wb.ind.mr <- ggplot()  + 
  geom_line(data =  mean.xdf1_W_N, aes(x = point, y = med.value), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf1_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf1_W, aes(y = true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.ind.mr.png", plot = wb.ind.mr, height = 5, width = 6.5)

wb.mean.mr <- ggplot()  + 
  geom_line(data =  mean.xdf2_W_N, aes(x = point, y = med.value), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf2_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf2_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf2_W, aes(y = true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.mean.mr.png", plot = wb.mean.mr, height = 5, width = 6.5)

wb.inv.mr <- ggplot()  + 
  geom_line(data =  mean.xdf3_W_N, aes(x = point, y = med.value), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf3_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf3_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf3_W, aes(y = true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.inv.mr.png", plot = wb.inv.mr, height = 5, width = 6.5)

wb.mean.inv.mr <- ggplot()  + 
  geom_line(data =  mean.xdf4_W_N, aes(x = point, y = med.value), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf4_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf4_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf4_W, aes(y = true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.mean.inv.mr.png", plot = wb.mean.inv.mr, height = 5, width = 6.5)

wb.inv.mean.mr <- ggplot()  + 
  geom_line(data =  mean.xdf5_W_N, aes(x = point, y = med.value, color = "Narrow"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi, fill = "Narrow"), alpha = 0.3)  + 
  geom_line(data =  mean.xdf5_W, aes(x = point, y = med.value, color = "Wide"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf5_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi, fill = "Wide"), alpha = 0.3)  + 
  geom_line(data = mean.xdf5_W, aes(x = point, y = true_curve, color = "True Curve"), linetype = "dashed")  + 
    labs(x = "Temperature", 
       y = "Mortality Rate", 
       fill = "95% HDI Bands", 
       color = "Posterior Curve")  + 
  scale_color_manual(values = c("Narrow" = mako(10)[8], "Wide" = plasma(10)[8], "True Curve" = "black"))  + 
  scale_fill_manual(values = c("Narrow" = mako(10)[8], "Wide" = plasma(10)[8]))  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.inv.mean.mr.png", plot = wb.inv.mean.mr, height = 5, width = 7.5)

wb.wb.ind.mr <- ggplot()  + 
  geom_line(data =  mean.xdf6_W_N, aes(x = point, y = med.value), color = mako(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W_N, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = mako(10)[8], alpha = 0.3)  + 
  geom_line(data =  mean.xdf6_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf6_W, aes(y = true_curve, x = point), color = "black", linetype = "dashed") + 
    labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  # Increase axis title size
  )
ggsave("wb.wb.ind.mr.png", plot = wb.wb.ind.mr, height = 5, width = 6.5)
```



```{r weibull.data.compare}
wb.exp.plot.mr <- ggplot()  + 
  geom_line(data = mean.xdf1_W, aes(x = point, y = med.value), color = plasma(10)[8], lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[8], alpha = 0.3)  + 
  geom_line(data = mean.xdf6_W, aes(x = point, y = med.value), color = plasma(10)[2], lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W, aes(x = point, ymin = lower.hdi, ymax = upper.hdi), fill = plasma(10)[2], alpha = 0.3)  + 
  geom_line(data = mean.xdf1_W, aes(x = point, y = true_curve), color = "black", linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Mortality Rate")  + 
  theme_minimal() + 
  theme(
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  
  )
ggsave("wb.comp.mort.png", plot = wb.exp.plot.mr, width = 5, height = 5)

wb.exp.plot.life <- ggplot()  + 
  geom_line(data = mean.xdf1_W, aes(x = point, y = med.value.inv, color = "Exponential Model"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf1_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv, fill = "Exponential Model"), alpha = 0.3)  + 
  geom_line(data = mean.xdf6_W, aes(x = point, y = med.value.inv, color = "Weibull Model"), lwd = 1)  + 
  geom_ribbon(data = mean.xdf6_W, aes(x = point, ymin = lower.hdi.inv, ymax = upper.hdi.inv, fill = "Weibull Model"), alpha = 0.3)  + 
  geom_line(data = mean.xdf1_W, aes(x = point, y = 1/true_curve, color = "True Curve"), linetype = "dashed")  + 
  labs(x = "Temperature", 
       y = "Lifetime", 
       color = "Curve", 
       fill = "95% HDI Bands")  + 
  scale_color_manual(values = c("Exponential Model" = plasma(10)[8], "Weibull Model" = plasma(10)[2], "True Curve" = "black"))  + 
  scale_fill_manual(values = c("Exponential Model" = plasma(10)[8], "Weibull Model" = plasma(10)[2]))  + 
  theme_minimal() + 
  theme(
    legend.text = element_text(size = 14),  # Increase legend text size
    legend.title = element_text(size = 16),
    axis.text = element_text(size = 14),  # Increase axis text size
    axis.title = element_text(size = 16)  
  )

ggsave("wb.comp.life.png", plot = wb.exp.plot.life, width = 7.5, height = 5)

```



```{r data.example.exp}
data.list[[100]]$inv.trait <- 1/data.list[[100]]$trait
group_means.plot <- tapply(data.list[[100]]$trait, data.list[[100]]$Temp, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.plot <- data.frame(
    Temp = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.plot)  # Extract means and unlist the result
    )
group_means.inv.plot <- tapply(data.list[[100]]$inv.trait, data.list[[100]]$Temp, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.plot <- data.frame(
    Temp = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.plot)  # Extract means and unlist the result
    )


ind.plot <- ggplot(data.list[[100]], aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "Lifetime") + 
  theme_classic()
ggsave("ind.plot.png", plot = ind.plot, width = 3, height = 3)
mean.plot <- ggplot(df.mean.plot, aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "Lifetime") + 
  theme_classic()
ggsave("mean.plot.png", plot = mean.plot, width = 3, height = 3)
inv.plot <- ggplot(data.list[[100]], aes(x = Temp, y = 1/trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("inv.plot.png", plot = inv.plot, width = 3, height = 3)
mean.inv.plot <- ggplot(df.mean.plot, aes(x = Temp, y = 1/trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("mean.inv.plot.png", plot = mean.inv.plot, width = 3, height = 3)
inv.mean.plot <- ggplot(df.mean.inv.plot, aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("inv.mean.plot.png", plot = inv.mean.plot, width = 3, height = 3)

gridExtra::grid.arrange(ind.plot, mean.plot, inv.plot, mean.inv.plot, inv.mean.plot, nrow = 2)
```

```{r data.example.wb}
Weibull_data.list[[100]]$inv.trait <- 1/Weibull_data.list[[100]]$trait
wb.group_means.plot <- tapply(Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$Temp, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
wb.df.mean.plot <- data.frame(
    Temp = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(wb.group_means.plot)  # Extract means and unlist the result
    )
wb.group_means.inv.plot <- tapply(Weibull_data.list[[100]]$inv.trait, Weibull_data.list[[100]]$Temp, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
wb.df.mean.inv.plot <- data.frame(
    Temp = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(wb.group_means.inv.plot)  # Extract means and unlist the result
    )


wb.ind.plot <- ggplot(Weibull_data.list[[100]], aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "Lifetime") + 
  theme_classic()
ggsave("wb.ind.plot.png", plot = wb.ind.plot, width = 3, height = 3)
wb.mean.plot <- ggplot(wb.df.mean.plot, aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "Lifetime") + 
  theme_classic()
ggsave("wb.mean.plot.png", plot = wb.mean.plot, width = 3, height = 3)
wb.inv.plot <- ggplot(Weibull_data.list[[100]], aes(x = Temp, y = 1/trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("wb.inv.plot.png", plot = wb.inv.plot, width = 3, height = 3)
wb.mean.inv.plot <- ggplot(wb.df.mean.plot, aes(x = Temp, y = 1/trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("wb.mean.inv.plot.png", plot = wb.mean.inv.plot, width = 3, height = 3)
wb.inv.mean.plot <- ggplot(wb.df.mean.inv.plot, aes(x = Temp, y = trait)) + 
  geom_point() + 
  labs(x = "Temperature", y = "1/Lifetime") + 
  theme_classic()
ggsave("wb.inv.mean.plot.png", plot = wb.inv.mean.plot, width = 3, height = 3)

#gridExtra::grid.arrange(wb.ind.plot, wb.mean.plot, wb.inv.plot, wb.mean.inv.plot, wb.inv.mean.plot, nrow = 2)
```



```{r pdf.cdf}
# Define x range
x <- seq(0, 10, length.out = 1000)

# Exponential PDF and CDF
exp_pdf <- dexp(x, rate = f(10))
exp_cdf <- pexp(x, rate = f(10))

# Mean lifetime function (concave down)
my.mean <- function(x, a = 0.001094, mu = 22.3, c = 0.066){
  1 / (a * (x - mu)^2 + c)
}
# Lambda so that mean = my.mean(x)
my.lambda.mean <- function(x, a = 0.001094, mu = 22.3, c = 0.066, sh.est = 3){ 
  my.mean(x, a, mu, c) / gamma(1 + 1/sh.est)
}

# Weibull PDF and CDF
weibull_pdf <- dweibull(x, shape = 3, scale = my.lambda.mean(10))
weibull_cdf <- pweibull(x, shape = 3, scale = my.lambda.mean(10))

# Plot PDFs
ggplot()  + 
  geom_line(aes(x = x, y = exp_pdf, color = "Exponential"), lwd = 2)  + 
  geom_line(aes(x = x, y = weibull_pdf, color = "Weibull"), lwd = 2)  + 
  geom_vline(xintercept = 1/f(10), color = "black", size = 1.5) +
  geom_line(aes(x = c(0, 0), y = c(0, 0), color = "Exponential and Weibull Mean")) +
  labs(x = "Lifetime", 
       y = "Density", 
       color = "Distribution")  + 
  scale_color_manual(values = c("Exponential" = viridis(3)[2], 
                                "Weibull" = viridis(3)[3], 
                                "Exponential and Weibull Mean" = "black"),
                     breaks = c("Exponential", "Weibull", "Exponential and Weibull Mean")) +
  theme_classic(base_size = 18) +
  theme(legend.position = "none")
ggsave("pdf.10.png", width = 6, height = 5)


# Plot CDFs
ggplot()  + 
  geom_line(aes(x = x, y = exp_cdf, color = "Exponential"), lwd = 2)  + 
  geom_line(aes(x = x, y = weibull_cdf, color = "Weibull"), lwd = 2)  + 
  geom_vline(xintercept = 1/f(10), color = "black", size = 1.5) +
  geom_line(aes(x = c(0, 0), y = c(0, 0), color = "Exponential and Weibull Mean"), size = 1.5) +
  labs(x = "Lifetime", 
       y = "Cumulative Probability", 
       color = "Distribution")  + 
  scale_color_manual(values = c("Exponential" = viridis(3)[2], 
                                "Weibull" = viridis(3)[3], 
                                "Exponential and Weibull Mean" = "black"),
                     breaks = c("Exponential", "Weibull", "Exponential and Weibull Mean")) +
  theme_classic(base_size = 18) +
  theme(
    legend.position = c(0.77, 0.3),        # move legend inside
    legend.background = element_rect(fill = "white", color = "white"),
    legend.text = element_text(size = 16)
  )
ggsave("cdf.10.png", width = 8, height = 5.5)

set.seed(3)
weibull_data.10 <- rweibull(n = 10000, scale = my.lambda.mean(10), shape = sh.est)
exp_data.10 <- rexp(n = 10000, rate = f(10))
# Create histograms with transparent colors for overlay
breaks <- hist(exp_data.10, plot = FALSE, breaks = 30)$breaks
ggplot()  + 
  geom_histogram(aes(weibull_data.10, y = ..density.., fill = "Weibull"), breaks = breaks, 
                 alpha = 0.5, color = "black")  + 
  geom_histogram(aes(exp_data.10, y = ..density.., fill = "Exponential"), breaks = breaks, 
                 alpha = 0.5, color = "black")  + 
  geom_vline(aes(xintercept = 1/f(10), color = "Exponential and Weibull Mean"), size = 1.5) +
  labs(x = "Lifetime", 
       y = "Density", 
       fill = "Distribution",
       color = "Mean")  + 
 scale_color_manual(values = c("Exponential" = viridis(3)[2], 
                                "Weibull" = viridis(3)[3], 
                                "Exponential and Weibull Mean" = "black"),
                     breaks = c("Exponential", "Weibull", "Exponential and Weibull Mean")) +
  scale_fill_manual(values = c("Exponential" = viridis(3)[2], "Weibull" = viridis(3)[3]))  + 
  scale_linetype_manual(values = c("Exponential and Weibull Mean" = "solid")) +
  theme_classic(base_size = 18) +
  theme(
    legend.position = c(0.7, 0.5),        # move legend inside
    legend.background = element_rect(fill = "white", color = "white"),
    legend.text = element_text(size = 16)
  )
ggsave("hist.10.png", width = 9, height = 5.5)


```

```{r mort.life.curve}
# Create data
x_vals <- seq(5, 40, by = 0.01)
y_vals <- f(x_vals)
inv_y_vals <- 1 / y_vals

curve_data <- data.frame(
  x = x_vals,
  y = y_vals,
  inv_y = inv_y_vals
)

# Plot 1: Original curve
mort.ex <- ggplot(curve_data, aes(x = x, y = y)) +
  geom_line(size = 2) +
  labs(x = "Temperature", y = "Mortality", title = expression(f(T))) +
  theme_minimal(base_size = 16)

# Plot 2: Inverse curve
life.ex <- ggplot(curve_data, aes(x = x, y = inv_y)) +
  geom_line(size = 2) +
  labs(x = "Temperature", y = "Lifetime", title = expression(f(T)^-1)) +
  theme_minimal(base_size = 16)

# Combine plots side by side
mort.life.ex <- mort.ex + life.ex + plot_layout(ncol = 2)

# Save
ggsave("mort.life.ex.png", plot = mort.life.ex, width = 14, height = 6)
```



