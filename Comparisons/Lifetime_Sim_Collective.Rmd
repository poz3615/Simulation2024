---
title: "Collection of Tick Simulation"
author: "Piper Zimmerman"
date: "December 12, 2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE)
library(ggplot2)
library(EnvStats)
```

```{r load.wide.exp}
load("individual_exponential.RData")
load("mean_exponential.RData")
load("inverse_exponential.RData")
load("mean_inverse_exponential.RData")
load("inverse_mean_exponential.RData")
load("inverse_notrunc.RData")
load("mean_inverse_notrunc.RData")
load("inverse_mean_notrunc.RData")
```

```{r load.wide.wb}
load("Weibull_individual.RData")
load("Weibull_mean.RData")
load("Weibull_inverse.RData")
load("Weibull_mean_inverse.RData")
load("Weibull_inverse_mean.RData")
load("Weibull_weibull_data.RData")
```


```{r plot.a.wide}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.a <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a$x <- factor(df.a$x, levels = desired_order)
a.plot <- ggplot(df.a, aes(x, Mean))+
  geom_point(col="blue") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.a, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
a.plot
```

```{r plot.b.wide}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.b <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[1]))
)
df.b$x <- factor(df.b$x, levels = desired_order)
b.plot <- ggplot(df.b, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.b, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
b.plot
```

```{r plot.c.wide}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.c <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c$x <- factor(df.c$x, levels = desired_order)
c.plot <- ggplot(df.c, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.c, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
c.plot
```

```{r plot.a.wide.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.a_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a_notrunc$x <- factor(df.a_notrunc$x, levels = desired_order)
a_notrunc.plot <- ggplot(df.a_notrunc, aes(x, Mean))+
  geom_point(col="blue") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.a, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
a_notrunc.plot
```

```{r plot.b.wide.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.b_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[1]))
)
df.b_notrunc$x <- factor(df.b_notrunc$x, levels = desired_order)
b_notrunc.plot <- ggplot(df.b_notrunc, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.b, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
b_notrunc.plot
```

```{r plot.c.wide.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

df.c_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c_notrunc$x <- factor(df.c_notrunc$x, levels = desired_order)
c_notrunc.plot <- ggplot(df.c_notrunc, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.c, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
c_notrunc.plot
```

```{r plot.a.wide.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

log_df.a <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[1]))
)
log_df.a$x <- factor(log_df.a$x, levels = desired_order)
log_a.plot <- ggplot(log_df.a, aes(x, log(Mean)))+
  geom_point(col="blue") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.a), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_a.plot
```

```{r plot.b.wide.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

log_df.b <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[1]))
)
log_df.b$x <- factor(log_df.b$x, levels = desired_order)
log_b.plot <- ggplot(log_df.b, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.b), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_b.plot
```

```{r plot.c.wide.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")

log_df.c <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[1]))
)
log_df.c$x <- factor(log_df.c$x, levels = desired_order)
log_c.plot <- ggplot(log_df.c, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.c), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_c.plot
```

```{r plot.a.wide.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_df.a_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[1]))
)
log_df.a_notrunc$x <- factor(log_df.a_notrunc$x, levels = desired_order)
log_a_notrunc.plot <- ggplot(log_df.a_notrunc, aes(x, log(Mean)))+
  geom_point(col="blue") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.a), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_a_notrunc.plot
```

```{r plot.b.wide.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_df.b_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[1]))
)
log_df.b_notrunc$x <- factor(log_df.b_notrunc$x, levels = desired_order)
log_b_notrunc.plot <- ggplot(log_df.b_notrunc, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.b), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_b_notrunc.plot
```

```{r plot.c.wide.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_df.c_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[1]))
)
log_df.c_notrunc$x <- factor(log_df.c_notrunc$x, levels = desired_order)
log_c_notrunc.plot <- ggplot(log_df.c_notrunc, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.c), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_c_notrunc.plot
```



```{r plot.a.wide.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")

df.a.wb <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a.wb$x <- factor(df.a.wb$x, levels = desired_order.wb)
a.wb.plot <- ggplot(df.a.wb, aes(x, Mean))+
  geom_point(col="orange") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.exp.a, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
a.wb.plot
```

```{r plot.b.wide.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")

df.b.wb <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))),
  upper = c(hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[2]),
  lower = c(hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[1])
)
df.b.wb$x <- factor(df.b.wb$x, levels = desired_order.wb)
b.wb.plot <- ggplot(df.b.wb, aes(x, Mean))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.exp.b, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
b.wb.plot
```

```{r plot.c.wide.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.c.wb <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c.wb$x <- factor(df.c.wb$x, levels = desired_order.wb)
c.wb.plot <- ggplot(df.c.wb, aes(x, Mean))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.exp.c, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
c.wb.plot
```

```{r plot.a.wide.wb.log}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.a.wb.log <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a.wb.log$x <- factor(df.a.wb.log$x, levels = desired_order.wb)
a.wb.log.plot <- ggplot(df.a.wb.log, aes(x, log(Mean)))+
  geom_point(col="orange") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.exp.a), linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
a.wb.log.plot
```

```{r plot.b.wide.wb.log}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.b.wb.log <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))),
  upper = c(hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[2]),
  lower = c(hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[1])
)
df.b.wb.log$x <- factor(df.b.wb.log$x, levels = desired_order.wb)
b.wb.log.plot <- ggplot(df.b.wb.log, aes(x, log(Mean)))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.exp.b), linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
b.wb.log.plot
```

```{r plot.c.wide.wb.log}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.c.wb.log <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c.wb.log$x <- factor(df.c.wb.log$x, levels = desired_order.wb)
c.wb.log.plot <- ggplot(df.c.wb.log, aes(x, log(Mean)))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.exp.c), linetype = "dashed", color = "slateblue3")+
  theme_classic()+coord_flip()
c.wb.log.plot
```



```{r plot.a.wide.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.a.compare <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))-true.exp.a),
  
  upper = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a),
  
  lower = c(exp(hdi(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a)
)
df.a.compare$x <- factor(df.a.compare$x, levels = desired_order.compare)
df.a.compare$upper<-ifelse(df.a.compare$upper>0.01,0.01,df.a.compare$upper)
a.compare.plot <- ggplot(df.a.compare, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  #ylim(-0.01,0.01)+
  coord_flip()
a.compare.plot
```

```{r plot.b.wide.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.b.compare <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))-true.exp.b),
  
  upper = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            (hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b),
  
  lower = c(exp(hdi(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            (hdi(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b)
)
df.b.compare$x <- factor(df.b.compare$x, levels = desired_order.compare)
df.b.compare$upper<-ifelse(df.b.compare$upper>0.16 & df.b.compare$lower<0.16,0.16,df.b.compare$upper)
b.compare.plot <- ggplot(df.b.compare, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  #ylim(-0.16,0.16)+
  coord_flip()
b.compare.plot
```

```{r plot.c.wide.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.c.compare <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1]))))-true.exp.c),
  
  upper = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c),
  
  lower = c((hdi(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c)
)
df.c.compare$x <- factor(df.c.compare$x, levels = desired_order.compare)
df.c.compare$upper<-ifelse(df.c.compare$upper>0.55,0.55,df.c.compare$upper)
c.compare.plot <- ggplot(df.c.compare, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  #ylim(-0.55,0.55)+
  coord_flip()
c.compare.plot
```



```{r exp.topt.maxlife.mean}
# TRUE
f<-function(x,a=0.001094,b=0.0488,c=0.609){
  a*x^2-b*x+c
}

# IND EXP DATA EXP MODEL
ind.exp<-function(x){
  (exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))
}

# MEAN EXP DATA EXP MODEL
mean.exp<-function(x){
  (exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))
}

# INV EXP DATA EXP MODEL
inv.exp<-function(x){
  (exp(mean(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 1]))))
}
inv.exp.trunc<-function(x){
  ifelse(inv.exp(x) < 0, 0.01, inv.exp(x))
}

# MEAN INV EXP DATA EXP MODEL
mean.inv.exp<-function(x){
  (exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1]))))
}
mean.inv.exp.trunc<-function(x){
  ifelse(mean.inv.exp(x) < 0, 0.01, mean.inv.exp(x))
}

# INV MEAN EXP DATA EXP MODEL
inv.mean.exp<-function(x){
  (exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1]))))
}
inv.mean.exp.trunc<-function(x){
  ifelse(inv.mean.exp(x) < 0, 0.01, inv.mean.exp(x))
}

# INV EXP DATA EXP MODEL NT
inv.exp.nt<-function(x){
  (exp(mean(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 1]))))
}
inv.exp.nt.trunc<-function(x){
  ifelse(inv.exp.nt(x) < 0, 0.01, inv.exp.nt(x))
}

# MEAN INV EXP DATA EXP MODEL NT
mean.inv.exp.nt<-function(x){
  (exp(mean(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 1]))))
}
mean.inv.exp.nt.trunc<-function(x){
  ifelse(mean.inv.exp.nt(x) < 0, 0.01, mean.inv.exp.nt(x))
}

# INV MEAN EXP DATA EXP MODEL NT
inv.mean.exp.nt<-function(x){
  (exp(mean(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 1]))))*x^2-
         exp(mean(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 1]))))*x+
         mean(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 1]))))
}
inv.mean.exp.nt.trunc<-function(x){
  ifelse(inv.mean.exp.nt(x) < 0, 0.01, inv.mean.exp.nt(x))
}

topt.mean.exp<-data.frame(
  Topt=c(optimize(ind.exp, interval = c(-100, 200))$minimum,
         optimize(mean.exp, interval = c(-100, 200))$minimum,
         optimize(inv.exp.trunc, interval = c(-100, 200))$minimum,
         optimize(mean.inv.exp.trunc, interval = c(-100, 200))$minimum,
         optimize(inv.mean.exp.trunc, interval = c(-100, 200))$minimum,
         optimize(inv.exp.nt.trunc, interval = c(-100, 200))$minimum,
         optimize(mean.inv.exp.nt.trunc, interval = c(-100, 200))$minimum,
         optimize(inv.mean.exp.nt.trunc, interval = c(-100, 200))$minimum,
         optimize(f,interval = c(-100, 200))$minimum),
  Lifetime=c(1/optimize(ind.exp, interval = c(-100, 200))$objective,
            1/optimize(mean.exp, interval = c(-100, 200))$objective,
            1/optimize(inv.exp.trunc, interval = c(-100, 200))$objective,
            1/optimize(mean.inv.exp.trunc, interval = c(-100, 200))$objective,
            1/optimize(inv.mean.exp.trunc, interval = c(-100, 200))$objective,
            1/optimize(inv.exp.nt.trunc, interval = c(-100, 200))$objective,
            1/optimize(mean.inv.exp.nt.trunc, interval = c(-100, 200))$objective,
            1/optimize(inv.mean.exp.nt.trunc, interval = c(-100, 200))$objective,
            1/optimize(f,interval = c(-100, 200))$objective
            ),
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model","True Curve"),levels=c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model", "True Curve"))
)

# Center point coordinates
center_x.exp <- topt.mean.exp$Topt[9]
center_y.exp <- topt.mean.exp$Lifetime[9]

# Plotting
ggplot(topt.mean.exp, aes(x = Topt, y = Lifetime,color=Method)) +
  geom_point() +
  geom_point(x = center_x.exp, y = center_y.exp, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Lifetime vs Topt (Posterior Mean)",
       subtitle="Data Generated from Exponential Distribution",
       x = "Topt",
       y = "Lifetime") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.exp - 24, center_x.exp + 24), ylim = c(center_y.exp - 85, center_y.exp + 85))

```

```{r exp.topt.maxlife.boxplot}
evaluate_expression <- function(x, a, b, c) {
  result <- a * x^2 - b * x + c
  result[result < 0.01] <- 0.01
  return(result)
}

df_list <- list(df.new1, df.new2, df.new3, df.new4, df.new5, df.new3.NT, df.new4.NT, df.new5.NT)
min_x_values_list <- list()
min_values_list <- list()

for (df in df_list) {
  min_x_values <- numeric()
  min_values <- numeric()
  for (i in 1:nrow(df)) {
    a <- exp(df[i,4])
    b <- exp(df[i,1])
    c <- df[i,2]
    responses <- evaluate_expression(xseq, a, b, c)
    min_x <- xseq[which.min(responses)]
    min_value <- min(responses)
    min_x_values <- c(min_x_values, min_x)
    min_values <- c(min_values, min_value)
  }
  min_x_values_list[[length(min_x_values_list) + 1]] <- min_x_values
  min_values_list[[length(min_values_list) + 1]] <- min_values
}

double.box.df<-data.frame(
  Topt = c(min_x_values_list[[1]],
           min_x_values_list[[2]],
           min_x_values_list[[3]],
           min_x_values_list[[4]],
           min_x_values_list[[5]],
           min_x_values_list[[6]],
           min_x_values_list[[7]],
           min_x_values_list[[8]],
           23.3034735),
  Lifetime = c(1/min_values_list[[1]],
               1/min_values_list[[2]],
               1/min_values_list[[3]],
               1/min_values_list[[4]],
               1/min_values_list[[5]],
               1/min_values_list[[6]],
               1/min_values_list[[7]],
               1/min_values_list[[8]],
               15.433231),
  Method=factor(c(rep("Individual Exp Data, Exp Model",938), rep("Mean Exp Data, Exp Model", 938), rep("Individual Inverse Exp Data, Exp Model", 938),
               rep("Mean Inverse Exp Data, Exp Model", 938), rep("Inverse Mean Exp Data, Exp Model", 938), rep("Individual Inverse Exp Data, Exp NT Model", 938),
               rep("Mean Inverse Exp Data, Exp NT Model",938), rep("Inverse Mean Exp Data, Exp NT Model",938), "True Curve")
               )
)

plot.x <- ggplot(double.box.df, aes(x= Method,y= Topt))+
  geom_boxplot()
plot.x <- layer_data(plot.x)[,1:18]

plot.y <- ggplot(double.box.df, aes(x= Method,y= Lifetime))+
  geom_boxplot() 
plot.y <- layer_data(plot.y)[,1:18]

dub<- double.box.df |> group_by(Method) |> summarise(medianTopt=median(Topt),
                                                     medianLife=median(Lifetime),
                                                     q1Topt=quantile(Topt,probs=0.25),
                                                     q3Topt=quantile(Topt,probs=0.75),
                                                     q1Life=quantile(Lifetime,probs=0.25),
                                                     q3Life=quantile(Lifetime,probs=0.75)) |> 
  mutate(iqrTopt=q3Topt-q1Topt,
         iqrLife=q3Life-q1Life,
         maxTopt=ifelse(q3Topt+1.5*iqrTopt>100,100,q3Topt+1.5*iqrTopt),
         minTopt=ifelse(q1Topt-1.5*iqrTopt<0,0,q1Topt-1.5*iqrTopt),
         maxLife=ifelse(q3Life+1.5*iqrLife>100,100,q3Life+1.5*iqrLife),
         minLife=ifelse(q1Life-1.5*iqrLife<0,0,q1Life-1.5*iqrLife),
         Middle.Topt = plot.x$middle,
         Middle.Life = plot.y$middle,)

medianTopt.True<- as.numeric(rep(dub[9,2],8))
medianLife.True<- as.numeric(rep(dub[9,3],8))

colnames(plot.x) <- paste0("x.", gsub("y", "", colnames(plot.x)))
colnames(plot.y) <- paste0("y.", gsub("y", "", colnames(plot.y)))
df <- cbind(plot.x, plot.y)
df$Method <- factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Inverse Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model", "Inverse Mean Exp Data, Exp NT Model", "True Curve"))
df.outliers <- df |>
  select(Method, x.middle, x.outliers, y.middle, y.outliers) |>
  data.table::data.table()
df.outliers <- df.outliers[, list(x.outliers = unlist(df.outliers$x.outliers), y.outliers = c(unlist(df.outliers$y.outliers),rep(NA,29))),
                           by = list(Method, x.middle, y.middle)]

ggplot(data=dub[1:8,], aes(fill = Method, color = Method)) +
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), alpha = 0.3) +
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), 
            color = "black", fill = NA) +
  geom_segment(aes(x = minTopt, y = plot.y$y.middle[1:8], xend = maxTopt, yend = plot.y$y.middle[1:8])) + #whiskers
  geom_segment(aes(x = minTopt, y = q1Life, xend = minTopt, yend = q3Life)) + #lower end
  geom_segment(aes(x = maxTopt, y = q1Life, xend = maxTopt, yend = q3Life)) + #upper end
  geom_segment(aes(x = plot.x$x.middle[1:8], y = minLife, xend = plot.x$x.middle[1:8], yend = maxLife)) + #whiskers
  geom_segment(aes(x = q1Topt, y = minLife, xend = q3Topt, yend = minLife)) + #lower end
  geom_segment(aes(x = q1Topt, y = maxLife, xend = q3Topt, yend = maxLife)) + #upper end
  #geom_point(data = df.outliers, aes(x = x.outliers, y = y.middle), size = 1, shape = 1) + # x-direction
  #geom_point(data = df.outliers, aes(x = x.middle, y = y.outliers), size = 1, shape = 1) + # y-direction
  theme_classic()+
  #facet_wrap(dub$Method[1:8],scales="free_y",nrow=2)+
  geom_point(aes(x=medianTopt.True, y= medianLife.True),color="black")+
  theme(legend.position="none")+
  labs(title= "Boxplot of Topt and Lifetime",
       x="Topt",
       y="Lifetime")

```

```{r WB.topt.maxlife.mean}
# TRUE
true_curve.inv.wb <- function(x) exp(true.exp.a * x^2 - true.exp.b * x + true.exp.c)

# IND WB DATA EXP MODEL
ind.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1])))))
}

# MEAN WB DATA EXP MODEL
mean.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1])))))
}

# INV WB DATA EXP MODEL
inv.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))))
}


# MEAN INV WB DATA EXP MODEL
mean.inv.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))))
}


# INV MEAN WB DATA EXP MODEL
inv.mean.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))))
}


# IND WB DATA WB MODEL
ind.wb.wb<-function(x){
  exp((exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*x^2-
         mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1])))*x+
         mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))
}

topt.mean.wb<-data.frame(
  Topt=c(optimize(ind.wb, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(mean.wb, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.wb, interval = c(-100, 200))$minimum,
         optimize(mean.inv.wb, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.mean.wb, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(ind.wb.wb, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(true_curve.inv.wb,interval = c(min(xseq), max(xseq)))$minimum),
  Lifetime=c(1/optimize(ind.wb, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(mean.wb, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.wb, interval = c(-100, 200))$objective,
            1/optimize(mean.inv.wb, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.mean.wb, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(ind.wb.wb, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(true_curve.inv.wb,interval = c(min(xseq), max(xseq)))$objective
            ),
  Method=factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model", "True Curve"), levels= c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model", "True Curve"))
)

# Center point coordinates
center_x.wb <- topt.mean.wb$Topt[7]
center_y.wb <- topt.mean.wb$Lifetime[7]

# Plotting
ggplot(topt.mean.wb, aes(x = Topt, y = Lifetime,color=Method)) +
  geom_point() +
  geom_point(x = center_x.wb, y = center_y.wb, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Lifetime vs Topt (Posterior Mean)",
       subtitle="Data Generated from Weibull Distribution",
       x = "Topt",
       y = "Lifetime") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.wb - 1, center_x.wb + 1), ylim = c(center_y.wb - 2.5, center_y.wb + 2.5))
```

```{r WB.topt.maxlife.boxplot}
evaluate_expression.wb <- function(x, a, b, c) {
  result <- exp((a * x^2 - b * x + c))
  return(result)
}

df_list.wb <- list(df.new1_W, df.new2_W, df.new3_W, df.new4_W, df.new5_W, df.new6_W)
min_x_values_list.wb <- list()
min_values_list.wb <- list()

for (df.wb in df_list.wb) {
  min_x_values.wb <- numeric()
  min_values.wb <- numeric()
  for (i in 1:nrow(df.wb)) {
    a <- exp(df.wb[i,4])
    b <- df.wb[i,1]
    c <- df.wb[i,2]
    responses.wb <- evaluate_expression.wb(xseq, a, b, c)
    min_x.wb <- xseq[which.min(responses.wb)]
    min_value.wb <- min(responses.wb)
    min_x_values.wb <- c(min_x_values.wb, min_x.wb)
    min_values.wb <- c(min_values.wb, min_value.wb)
  }
  min_x_values_list.wb[[length(min_x_values_list.wb) + 1]] <- min_x_values.wb
  min_values_list.wb[[length(min_values_list.wb) + 1]] <- min_values.wb
}



double.box.df.wb<-data.frame(
  Topt = c(min_x_values_list.wb[[1]],
           min_x_values_list.wb[[2]],
           min_x_values_list.wb[[3]],
           min_x_values_list.wb[[4]],
           min_x_values_list.wb[[5]],
           min_x_values_list.wb[[6]],
           22.39709),
  Lifetime = c(1/min_values_list.wb[[1]],
               1/min_values_list.wb[[2]],
               1/min_values_list.wb[[3]],
               1/min_values_list.wb[[4]],
               1/min_values_list.wb[[5]],
               1/min_values_list.wb[[6]],
               15.44774),
  Method=factor(c(rep("Individual WB Data, Exp Model",938), rep("Mean WB Data, Exp Model", 938), rep("Individual Inverse WB Data, Exp Model", 938),
               rep("Mean Inverse WB Data, Exp Model", 938), rep("Inverse Mean WB Data, Exp Model", 938), rep("Individual WB Data, WB Model", 938),"True Curve"), levels = c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "Individual WB Data, WB Model",
                "True Curve")
               )
)
plot.x.wb <- ggplot(double.box.df.wb, aes(x= Method,y= Topt))+
  geom_boxplot()
plot.x.wb <- layer_data(plot.x.wb)[,1:18]

plot.y.wb <- ggplot(double.box.df.wb, aes(x= Method,y= Lifetime))+
  geom_boxplot() 
plot.y.wb <- layer_data(plot.y.wb)[,1:18]

colnames(plot.x.wb) <- paste0("x.", gsub("y", "", colnames(plot.x.wb)))
colnames(plot.y.wb) <- paste0("y.", gsub("y", "", colnames(plot.y.wb)))
df.wb <- cbind(plot.x.wb, plot.y.wb)
df.wb$Method <- factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "Individual WB Data, WB Model",
                "True Curve"))
df.outliers.wb<- df.wb |>
  select(Method, x.middle, x.outliers, y.middle, y.outliers) |>
  data.table::data.table()
df.outliers.wb <- df.outliers.wb[, list(x.outliers = unlist(df.outliers.wb$x.outliers), y.outliers = c(unlist(df.outliers.wb$y.outliers),rep(NA, 205))),
                           by = list(Method, x.middle, y.middle)]

dub.wb<- double.box.df.wb |> group_by(Method) |> summarise(medianTopt=median(Topt),
                                                     medianLife=median(Lifetime),
                                                     q1Topt=quantile(Topt,probs=0.25),
                                                     q3Topt=quantile(Topt,probs=0.75),
                                                     q1Life=quantile(Lifetime,probs=0.25),
                                                     q3Life=quantile(Lifetime,probs=0.75)) |> 
  mutate(iqrTopt=q3Topt-q1Topt,
         iqrLife=q3Life-q1Life,
         maxTopt=ifelse(q3Topt+1.5*iqrTopt>100,100,q3Topt+1.5*iqrTopt),
         minTopt=ifelse(q1Topt-1.5*iqrTopt<0,0,q1Topt-1.5*iqrTopt),
         maxLife=ifelse(q3Life+1.5*iqrLife>100,100,q3Life+1.5*iqrLife),
         minLife=ifelse(q1Life-1.5*iqrLife<0,0,q1Life-1.5*iqrLife),
         Middle.Topt = plot.x.wb$middle,
         Middle.Life = plot.y.wb$middle,)
dub.wb$Method <- factor(dub.wb$Method, levels = c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "Individual WB Data, WB Model",
                "True Curve"))
medianTopt.True.wb<- as.numeric(rep(dub.wb[7,2],6))
medianLife.True.wb<- as.numeric(rep(dub.wb[7,3],6))


ggplot(data=dub.wb[1:6,], aes(fill = Method, color = Method)) +
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), alpha = 0.3) +
  geom_rect(aes(xmin = q1Topt, xmax = q3Topt, ymin = q1Life, ymax = q3Life), 
            color = "black", fill = NA) +
  geom_segment(aes(x = minTopt, y = plot.y.wb$y.middle[1:6], xend = maxTopt, yend = plot.y.wb$y.middle[1:6])) + #whiskers
  geom_segment(aes(x = minTopt, y = q1Life, xend = minTopt, yend = q3Life)) + #lower end
  geom_segment(aes(x = maxTopt, y = q1Life, xend = maxTopt, yend = q3Life)) + #upper end
  geom_segment(aes(x = plot.x.wb$x.middle[1:6], y = minLife, xend = plot.x.wb$x.middle[1:6], yend = maxLife)) + #whiskers
  geom_segment(aes(x = q1Topt, y = minLife, xend = q3Topt, yend = minLife)) + #lower end
  geom_segment(aes(x = q1Topt, y = maxLife, xend = q3Topt, yend = maxLife)) + #upper end
  #geom_point(data = df.outliers.wb, aes(x = x.outliers, y = y.middle), size = 1, shape = 1) + # x-direction
  #geom_point(data = df.outliers.wb, aes(x = x.middle, y = y.outliers), size = 1, shape = 1) + # y-direction
  theme_classic()+
  geom_point(aes(x=medianTopt.True.wb, y= medianLife.True.wb),color="black")+
  facet_wrap(dub.wb$Method[1:6],nrow=2)+
  theme(legend.position="none")+
  labs(title= "Boxplot of Topt and Lifetime",
       x="Topt",
       y="Lifetime")
```

```{r exp.topt.maxlife.med}
# TRUE
f<-function(x,a=0.001094,b=0.0488,c=0.609){
  a*x^2-b*x+c
}

# IND EXP DATA EXP MODEL
ind.exp.med<-function(x){
  (exp(median(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 2]))))
}

# MEAN EXP DATA EXP MODEL
mean.exp.med<-function(x){
  (exp(median(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 2]))))
}

# INV EXP DATA EXP MODEL
inv.exp.med<-function(x){
  (exp(median(unlist(lapply(param_list3[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list3[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list3[[3]], function(matrix) matrix[, 2]))))
}
inv.exp.med.trunc<-function(x){
  ifelse(inv.exp.med(x) < 0, 0.01, inv.exp.med(x))
}

# MEAN INV EXP DATA EXP MODEL
mean.inv.exp.med<-function(x){
  (exp(median(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 2]))))
}
mean.inv.exp.med.trunc<-function(x){
  ifelse(mean.inv.exp.med(x) < 0, 0.01, mean.inv.exp.med(x))
}

# INV MEAN EXP DATA EXP MODEL
inv.mean.exp.med<-function(x){
  (exp(median(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 2]))))
}
inv.mean.exp.med.trunc<-function(x){
  ifelse(inv.mean.exp.med(x) < 0, 0.01, inv.mean.exp.med(x))
}

# INV EXP DATA EXP MODEL NT
inv.exp.med.nt<-function(x){
  (exp(median(unlist(lapply(param_list3_notrunc[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list3_notrunc[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list3_notrunc[[3]], function(matrix) matrix[, 2]))))
}
inv.exp.med.nt.trunc<-function(x){
  ifelse(inv.exp.med.nt(x) < 0, 0.01, inv.exp.med.nt(x))
}

# MEAN INV EXP DATA EXP MODEL NT
mean.inv.exp.med.nt<-function(x){
  (exp(median(unlist(lapply(param_list4_notrunc[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list4_notrunc[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list4_notrunc[[3]], function(matrix) matrix[, 2]))))
}
mean.inv.exp.med.nt.trunc<-function(x){
  ifelse(mean.inv.exp.med.nt(x) < 0, 0.01, mean.inv.exp.med.nt(x))
}

# INV MEAN EXP DATA EXP MODEL NT
inv.mean.exp.med.nt<-function(x){
  (exp(median(unlist(lapply(param_list5_notrunc[[1]], function(matrix) matrix[, 2]))))*x^2-
         exp(median(unlist(lapply(param_list5_notrunc[[2]], function(matrix) matrix[, 2]))))*x+
         median(unlist(lapply(param_list5_notrunc[[3]], function(matrix) matrix[, 2]))))
}
inv.mean.exp.med.nt.trunc<-function(x){
  ifelse(inv.mean.exp.med.nt(x) < 0, 0.01, inv.mean.exp.med.nt(x))
}

topt.mean.exp.med<-data.frame(
  Topt=c(optimize(ind.exp.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(mean.exp.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.exp.med.trunc, interval = c(-100, 200))$minimum,
         optimize(mean.inv.exp.med.trunc, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.mean.exp.med.trunc, interval = c(-100, 200))$minimum,
         optimize(inv.exp.med.nt.trunc, interval = c(-100, 200))$minimum,
         optimize(mean.inv.exp.med.nt.trunc, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.mean.exp.med.nt.trunc, interval = c(-100, 200))$minimum,
         optimize(f,interval = c(min(xseq), max(xseq)))$minimum),
  Lifetime=c(1/optimize(ind.exp.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(mean.exp.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.exp.med.trunc, interval = c(-100, 200))$objective,
            1/optimize(mean.inv.exp.med.trunc, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.mean.exp.med.trunc, interval = c(-100, 200))$objective,
            1/optimize(inv.exp.med.nt.trunc, interval = c(-100, 200))$objective,
            1/optimize(mean.inv.exp.med.nt.trunc, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.mean.exp.med.nt.trunc, interval = c(-100, 200))$objective,
            1/optimize(f,interval = c(min(xseq), max(xseq)))$objective
            ),
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model", "True Curve"), levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model", "True Curve"))
)

# Center point coordinates
center_x.exp.med <- topt.mean.exp.med$Topt[9]
center_y.exp.med <- topt.mean.exp.med$Lifetime[9]

# Plotting
ggplot(topt.mean.exp.med, aes(x = Topt, y = Lifetime,color=Method)) +
  geom_point() +
  geom_point(x = center_x.exp.med, y = center_y.exp.med, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Lifetime vs Topt (Posterior Median)",
       subtitle="Data Generated from Exponential Distribution",
       x = "Topt",
       y = "Lifetime") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.exp.med - 0.5, center_x.exp.med + 0.5), ylim = c(center_y.exp.med - 3, center_y.exp.med + 3))

```

```{r WB.topt.maxlife.med}
# TRUE
true_curve.inv.wb <- function(x) exp(true.exp.a * x^2 - true.exp.b * x + true.exp.c)

# IND WB DATA EXP MODEL
ind.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 2])))))
}

# MEAN WB DATA EXP MODEL
mean.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 2])))))
}

# INV WB DATA EXP MODEL
inv.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 2])))))
}

# MEAN INV WB DATA EXP MODEL
mean.inv.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 2])))))
}

# INV MEAN WB DATA EXP MODEL
inv.mean.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 2])))))
}

# IND WB DATA WB MODEL
ind.wb.wb.med<-function(x){
  exp((exp(median(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 2]))))*x^2-
         median(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 2])))*x+
         median(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 2])))))
}

topt.mean.wb.med<-data.frame(
  Topt=c(optimize(ind.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(mean.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(mean.inv.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(inv.mean.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(ind.wb.wb.med, interval = c(min(xseq), max(xseq)))$minimum,
         optimize(true_curve.inv.wb,interval = c(min(xseq), max(xseq)))$minimum),
  Lifetime=c(1/optimize(ind.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(mean.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(mean.inv.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(inv.mean.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(ind.wb.wb.med, interval = c(min(xseq), max(xseq)))$objective,
            1/optimize(true_curve.inv.wb,interval = c(min(xseq), max(xseq)))$objective
            ),
  Method=factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model","True Curve"), levels = c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model","True Curve"))
)

# Center point coordinates
center_x.wb.med <- topt.mean.wb.med$Topt[7]
center_y.wb.med <- topt.mean.wb.med$Lifetime[7]

# Plotting
ggplot(topt.mean.wb.med, aes(x = Topt, y = Lifetime,color=Method)) +
  geom_point() +
  geom_point(x = center_x.wb.med, y = center_y.wb.med, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Lifetime vs Topt (Posterior Median)",
       subtitle="Data Generated from Weibull Distribution",
       x = "Topt",
       y = "Lifetime") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.wb.med - 1, center_x.wb.med + 1), ylim = c(center_y.wb.med - 3, center_y.wb.med + 3))
```



```{r exp.extreme.mean}
solve_quadratic.mean <- function(f) {
  # Calculate discriminant
  a <- exp(mean(unlist(lapply(f[[1]], function(matrix) matrix[, 1]))))
  b <- -exp(mean(unlist(lapply(f[[2]], function(matrix) matrix[, 1]))))
  c <- mean(unlist(lapply(f[[3]], function(matrix) matrix[, 1])))
  discriminant <- b^2 - 4 * a * (c - 1)
  
  # Solve quadratic equation
  if (discriminant >= 0) {
    x1 <- (-b + sqrt(discriminant)) / (2 * a)
    x2 <- (-b - sqrt(discriminant)) / (2 * a)
    return(c(x1, x2))
  } else {
    warning("No real solutions for y = 1 in quadratic equation.")
    return(NA)
  }
}

ext.df.mean <- data.frame(
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model","True Curve"), levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model","True Curve")),
  Low=c(solve_quadratic.mean(param_list1)[2],
        solve_quadratic.mean(param_list2)[2],
        solve_quadratic.mean(param_list3)[2],
        solve_quadratic.mean(param_list4)[2],
        solve_quadratic.mean(param_list5)[2],
        solve_quadratic.mean(param_list3_notrunc)[2],
        solve_quadratic.mean(param_list4_notrunc)[2],
        solve_quadratic.mean(param_list5_notrunc)[2],
        -6.935
        ),
  High=c(solve_quadratic.mean(param_list1)[1],
         solve_quadratic.mean(param_list2)[1],
         solve_quadratic.mean(param_list3)[1],
         solve_quadratic.mean(param_list4)[1],
         solve_quadratic.mean(param_list5)[1],
         solve_quadratic.mean(param_list3_notrunc)[1],
         solve_quadratic.mean(param_list4_notrunc)[1],
         solve_quadratic.mean(param_list5_notrunc)[1],
         51.542)
)

center_x.exp.extreme <- ext.df.mean$Low[9]
center_y.exp.extreme <- ext.df.mean$High[9]

# Plotting
ggplot(ext.df.mean, aes(x = Low, y = High,color=Method)) +
  geom_point() +
  geom_point(x = center_x.exp.extreme, y = center_y.exp.extreme, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Temperatures where Predicted Lifetime Hits 1 Day (Posterior Mean)",
       subtitle="Data Generated from Exponential Distribution",
       x = "Low",
       y = "High") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.exp.extreme - 25, center_x.exp.extreme + 25), ylim = c(center_y.exp.extreme - 108, center_y.exp.extreme + 108))

```

```{r exp.extreme.boxplot}

df_list <- list(df.new1, df.new2, df.new3, df.new4, df.new5, df.new3.NT, df.new4.NT, df.new5.NT)

# Lists to store results
x_values_list <- list()

# Loop through dataframes
for (df in df_list) {
  x_values <- numeric()  
  for (i in 1:nrow(df)) {
    a <- exp(df[i, 4])  
    b <- -exp(df[i, 1])  
    c <- df[i, 2] 
    
    # Solve quadratic equation for x when y = 1
    discriminant <- b^2 - 4 * a * (c - 1)
    if (discriminant >= 0) {
      x1 <- (-b + sqrt(discriminant)) / (2 * a)
      x2 <- (-b - sqrt(discriminant)) / (2 * a)
      x_values <- c(x_values, x1, x2)  
    } else {
      # If discriminant < 0, no real solutions
      warning("No real solutions for y = 1 in quadratic equation.")
    }
  }
  x_values_list[[length(x_values_list) + 1]] <- x_values  
}

double.box.df.ex <- data.frame(Low = numeric(), High = numeric())

# Loop through the list
for (i in seq_along(x_values_list)) {
  # Extract values from the list
  x_values <- x_values_list[[i]]
  
  # Create a dataframe with even indices as "low" and odd indices as "high"
  temp_df <- data.frame(High = x_values[c(TRUE, FALSE)], Low = x_values[c(FALSE, TRUE)])
  
  # Bind the dataframe to the result dataframe
  double.box.df.ex <- rbind(double.box.df.ex, temp_df)
}
double.box.df.ex <- rbind(double.box.df.ex, data.frame(Low = -6.935,	 High = 51.542))

double.box.df.ex$Method <- factor(c(rep("Individual Exp Data, Exp Model",938), rep("Mean Exp Data, Exp Model", 938), rep("Individual Inverse Exp Data, Exp Model", 938),
               rep("Mean Inverse Exp Data, Exp Model", 938), rep("Inverse Mean Exp Data, Exp Model", 938), rep("Individual Inverse Exp Data, Exp NT Model", 938),
               rep("Mean Inverse Exp Data, Exp NT Model",938), rep("Inverse Mean Exp Data, Exp NT Model",938) , "True Curve" 
               )
)



plot.x.ex <- ggplot(double.box.df.ex, aes(x= Method,y= Low))+
  geom_boxplot()
plot.x.ex <- layer_data(plot.x.ex)[,1:18]

plot.y.ex <- ggplot(double.box.df.ex, aes(x= Method,y= High))+
  geom_boxplot() 
plot.y.ex <- layer_data(plot.y.ex)[,1:18]

dub.ex<- double.box.df.ex |> group_by(Method) |> summarise(medianLow=median(Low),
                                                     medianHigh=median(High),
                                                     q1Low=quantile(Low,probs=0.25),
                                                     q3Low=quantile(Low,probs=0.75),
                                                     q1High=quantile(High,probs=0.25),
                                                     q3High=quantile(High,probs=0.75)) |> 
  mutate(iqrLow=q3Low-q1Low,
         iqrHigh=q3High-q1High,
         maxLow=q3Low+1.5*iqrLow,
         minLow=q1Low-1.5*iqrLow,
         maxHigh=q3High+1.5*iqrHigh,
         minHigh=q3High-1.5*iqrHigh,
         Middle.Low = plot.x.ex$middle,
         Middle.High = plot.y.ex$middle)

dub.ex$Method <-factor(dub.ex$Method, levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Inverse Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model", "Inverse Mean Exp Data, Exp NT Model", "True Curve"))

medianLow.True.ex<- as.numeric(rep(dub.ex[9,2],8))
medianHigh.True.ex<- as.numeric(rep(dub.ex[9,3],8))

colnames(plot.x.ex) <- paste0("x.", gsub("y", "", colnames(plot.x.ex)))
colnames(plot.y.ex) <- paste0("y.", gsub("y", "", colnames(plot.y.ex)))
df.ex <- cbind(plot.x.ex, plot.y.ex)
df.ex$Method <- factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Inverse Mean Exp Data, Exp Model", "Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model", "Inverse Mean Exp Data, Exp NT Model", "True Curve"))
df.outliers.ex <- df.ex |>
  select(Method, x.middle, x.outliers, y.middle, y.outliers) |>
  data.table::data.table()

df.outliers.ex <- df.outliers.ex[, list(x.outliers = c(unlist(df.outliers.ex$x.outliers),rep(NA,27)), y.outliers = c(unlist(df.outliers.ex$y.outliers))),
                           by = list(Method, x.middle, y.middle)]

ggplot(data=dub.ex[1:8,], aes(fill = Method, color = Method)) +
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), alpha = 0.3) +
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), 
            color = "black", fill = NA) +
  geom_segment(aes(x = minLow, y = plot.y.ex$y.middle[1:8], xend = maxLow, yend = plot.y.ex$y.middle[1:8])) + #whiskers
  geom_segment(aes(x = minLow, y = q1High, xend = minLow, yend = q3High)) + #lower end
  geom_segment(aes(x = maxLow, y = q1High, xend = maxLow, yend = q3High)) + #upper end
  geom_segment(aes(x = plot.x.ex$x.middle[1:8], y = minHigh, xend = plot.x.ex$x.middle[1:8], yend = maxHigh)) + #whiskers
  geom_segment(aes(x = q1Low, y = minHigh, xend = q3Low, yend = minHigh)) + #lower end
  geom_segment(aes(x = q1Low, y = maxHigh, xend = q3Low, yend = maxHigh)) + #upper end
  #geom_point(data = df.outliers.ex, aes(x = x.outliers, y = y.middle), size = 1, shape = 1) + # x-direction
  #geom_point(data = df.outliers.ex, aes(x = x.middle, y = y.outliers), size = 1, shape = 1) + # y-direction
  theme_classic()+
  #facet_wrap(dub.ex$Method[1:8],scales="free_y",nrow=2)+
  geom_point(aes(x=medianLow.True.ex, y= medianHigh.True.ex),color="black")+
  theme(legend.position="none")+
  labs(title= "Boxplot of Extreme Temperatures",
       x="Low",
       y="High")

```

```{r WB.extreme.mean}

solve_quadratic.mean.wb <- function(f) {
  # Calculate discriminant
  a <- exp(mean(unlist(lapply(f[[1]], function(matrix) matrix[, 1]))))
  b <- -(mean(unlist(lapply(f[[2]], function(matrix) matrix[, 1]))))
  c <- mean(unlist(lapply(f[[3]], function(matrix) matrix[, 1])))
  discriminant <- b^2 - 4 * a * (c - log(1))
  
  # Solve quadratic equation
  if (discriminant >= 0) {
    x1 <- (-b + sqrt(discriminant)) / (2 * a)
    x2 <- (-b - sqrt(discriminant)) / (2 * a)
    return(c(x1, x2))
  } else {
    warning("No real solutions for y = 1 in quadratic equation.")
    return(NA)
  }
}

ext.df.mean.wb <- data.frame(
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual WB Data, WB Model", "True Curve"), 
               levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual WB Data, WB Model", "True Curve")),
  Low=c(solve_quadratic.mean.wb(Weibull_param_list1)[2],
        solve_quadratic.mean.wb(Weibull_param_list2)[2],
        solve_quadratic.mean.wb(Weibull_param_list3)[2],
        solve_quadratic.mean.wb(Weibull_param_list4)[2],
        solve_quadratic.mean.wb(Weibull_param_list5)[2],
        solve_quadratic.mean.wb(Weibull_param_list6)[2],
        4.192
        ),
  High=c(solve_quadratic.mean.wb(Weibull_param_list1)[1],
         solve_quadratic.mean.wb(Weibull_param_list2)[1],
         solve_quadratic.mean.wb(Weibull_param_list3)[1],
         solve_quadratic.mean.wb(Weibull_param_list4)[1],
         solve_quadratic.mean.wb(Weibull_param_list5)[1],
         solve_quadratic.mean.wb(Weibull_param_list6)[1],
         40.602)
)

center_x.wb.extreme <- ext.df.mean.wb$Low[7]
center_y.wb.extreme <- ext.df.mean.wb$High[7]

# Plotting
ggplot(ext.df.mean.wb, aes(x = Low, y = High,color=Method)) +
  geom_point() +
  geom_point(x = center_x.wb.extreme, y = center_y.wb.extreme, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Temperatures where Predicted Lifetime Hits 1 Day (Posterior Mean)",
       subtitle="Data Generated from Weibull Distribution",
       x = "Low",
       y = "High") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.wb.extreme - 2, center_x.wb.extreme + 2), ylim = c(center_y.wb.extreme - 26, center_y.wb.extreme + 26))

```

```{r WB.extreme.boxplot}

df_list.wb <- list(df.new1_W, df.new2_W, df.new3_W, df.new4_W, df.new5_W, df.new6_W)

# Lists to store results
x_values_list.wb <- list()

# Loop through dataframes
for (df in df_list.wb) {
  x_values.wb <- numeric()  
  for (i in 1:nrow(df)) {
    a <- exp(df[i, 4])  
    b <- -df[i, 1]  
    c <- df[i, 2] 
    
    # Solve quadratic equation for x when y = 1
    discriminant.wb <- b^2 - 4 * a * (c - log(1))
    if (discriminant.wb >= 0) {
      x1.wb <- (-b + sqrt(discriminant.wb)) / (2 * a)
      x2.wb <- (-b - sqrt(discriminant.wb)) / (2 * a)
      x_values.wb <- c(x_values.wb, x1.wb, x2.wb)  
    } else {
      # If discriminant < 0, no real solutions
      warning("No real solutions for y = 1 in quadratic equation.")
    }
  }
  x_values_list.wb[[length(x_values_list.wb) + 1]] <- x_values.wb  
}

double.box.df.ex.wb <- data.frame(Low = numeric(), High = numeric())

# Loop through the list
for (i in seq_along(x_values_list.wb)) {
  # Extract values from the list
  x_values.wb <- x_values_list.wb[[i]]
  
  # Create a dataframe with even indices as "low" and odd indices as "high"
  temp_df.wb <- data.frame(High = x_values.wb[c(TRUE, FALSE)], Low = x_values.wb[c(FALSE, TRUE)])
  
  # Bind the dataframe to the result dataframe
  double.box.df.ex.wb <- rbind(double.box.df.ex.wb, temp_df.wb)
}
double.box.df.ex.wb <- rbind(double.box.df.ex.wb, data.frame(Low = 4.192,	 High = 40.602))

double.box.df.ex.wb$Method <- factor(c(rep("Individual WB Data, Exp Model",938), rep("Mean WB Data, Exp Model", 938), rep("Individual Inverse WB Data, Exp Model", 938),
               rep("Mean Inverse WB Data, Exp Model", 938), rep("Inverse Mean WB Data, Exp Model", 938), rep("WB Data, WB Model", 938), "True Curve" 
               ),levels = c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "WB Data, WB Model", "True Curve")
)



plot.x.ex.wb <- ggplot(double.box.df.ex.wb, aes(x= Method,y= Low))+
  geom_boxplot()
plot.x.ex.wb <- layer_data(plot.x.ex.wb)[,1:18]

plot.y.ex.wb <- ggplot(double.box.df.ex.wb, aes(x= Method,y= High))+
  geom_boxplot() 
plot.y.ex.wb <- layer_data(plot.y.ex.wb)[,1:18]

dub.ex.wb<- double.box.df.ex.wb |> group_by(Method) |> summarise(medianLow=median(Low),
                                                     medianHigh=median(High),
                                                     q1Low=quantile(Low,probs=0.25),
                                                     q3Low=quantile(Low,probs=0.75),
                                                     q1High=quantile(High,probs=0.25),
                                                     q3High=quantile(High,probs=0.75)) |> 
  mutate(iqrLow=q3Low-q1Low,
         iqrHigh=q3High-q1High,
         maxLow=q3Low+1.5*iqrLow,
         minLow=q1Low-1.5*iqrLow,
         maxHigh=q3High+1.5*iqrHigh,
         minHigh=q3High-1.5*iqrHigh,
         Middle.Low = plot.x.ex.wb$middle,
         Middle.High = plot.y.ex.wb$middle)

dub.ex.wb$Method <-factor(dub.ex.wb$Method, levels = c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "WB Data, WB Model", "True Curve"))

medianLow.True.ex.wb<- as.numeric(rep(dub.ex.wb[7,2],6))
medianHigh.True.ex.wb<- as.numeric(rep(dub.ex.wb[7,3],6))

colnames(plot.x.ex.wb) <- paste0("x.", gsub("y", "", colnames(plot.x.ex.wb)))
colnames(plot.y.ex.wb) <- paste0("y.", gsub("y", "", colnames(plot.y.ex.wb)))
df.ex.wb <- cbind(plot.x.ex.wb, plot.y.ex.wb)
df.ex.wb$Method <- factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model", "Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model", "Inverse Mean WB Data, Exp Model", "WB Data, WB Model", "True Curve"))
df.outliers.ex.wb <- df.ex.wb |>
  select(Method, x.middle, x.outliers, y.middle, y.outliers) |>
  data.table::data.table()

df.outliers.ex.wb <- df.outliers.ex.wb[, list(x.outliers = c(unlist(df.outliers.ex.wb$x.outliers),rep(NA,45)), y.outliers = c(unlist(df.outliers.ex.wb$y.outliers))),
                           by = list(Method, x.middle, y.middle)]

ggplot(data=dub.ex.wb[1:6,], aes(fill = Method, color = Method)) +
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), alpha = 0.3) +
  geom_rect(aes(xmin = q1Low, xmax = q3Low, ymin = q1High, ymax = q3High), 
            color = "black", fill = NA) +
  geom_segment(aes(x = minLow, y = plot.y.ex.wb$y.middle[1:6], xend = maxLow, yend = plot.y.ex.wb$y.middle[1:6])) + #whiskers
  geom_segment(aes(x = minLow, y = q1High, xend = minLow, yend = q3High)) + #lower end
  geom_segment(aes(x = maxLow, y = q1High, xend = maxLow, yend = q3High)) + #upper end
  geom_segment(aes(x = plot.x.ex.wb$x.middle[1:6], y = minHigh, xend = plot.x.ex.wb$x.middle[1:6], yend = maxHigh)) + #whiskers
  geom_segment(aes(x = q1Low, y = minHigh, xend = q3Low, yend = minHigh)) + #lower end
  geom_segment(aes(x = q1Low, y = maxHigh, xend = q3Low, yend = maxHigh)) + #upper end
  geom_point(data = df.outliers.ex.wb, aes(x = x.outliers, y = y.middle), size = 1, shape = 1) + # x-direction
  geom_point(data = df.outliers.ex.wb, aes(x = x.middle, y = y.outliers), size = 1, shape = 1) + # y-direction
  theme_classic()+
  #facet_wrap(dub.ex.wb$Method[1:6],nrow=2)+
  geom_point(aes(x=medianLow.True.ex.wb, y= medianHigh.True.ex.wb),color="black")+
  theme(legend.position="none")+
  labs(title= "Boxplot of Extreme Temperatures",
       x="Low",
       y="High")

```

```{r exp.extreme.med}
solve_quadratic.med <- function(f) {
  # Calculate discriminant
  a <- exp(median(unlist(lapply(f[[1]], function(matrix) matrix[, 1]))))
  b <- -exp(median(unlist(lapply(f[[2]], function(matrix) matrix[, 1]))))
  c <- median(unlist(lapply(f[[3]], function(matrix) matrix[, 1])))
  discriminant <- b^2 - 4 * a * (c - 1)
  
  # Solve quadratic equation
  if (discriminant >= 0) {
    x1 <- (-b + sqrt(discriminant)) / (2 * a)
    x2 <- (-b - sqrt(discriminant)) / (2 * a)
    return(c(x1, x2))
  } else {
    warning("No real solutions for y = 1 in quadratic equation.")
    return(NA)
  }
}

ext.df.med <- data.frame(
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model","True Curve"), levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model",
               "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model","True Curve")),
  Low=c(solve_quadratic.med(param_list1)[2],
        solve_quadratic.med(param_list2)[2],
        solve_quadratic.med(param_list3)[2],
        solve_quadratic.med(param_list4)[2],
        solve_quadratic.med(param_list5)[2],
        solve_quadratic.med(param_list3_notrunc)[2],
        solve_quadratic.med(param_list4_notrunc)[2],
        solve_quadratic.med(param_list5_notrunc)[2],
        -6.935
        ),
  High=c(solve_quadratic.med(param_list1)[1],
         solve_quadratic.med(param_list2)[1],
         solve_quadratic.med(param_list3)[1],
         solve_quadratic.med(param_list4)[1],
         solve_quadratic.med(param_list5)[1],
         solve_quadratic.med(param_list3_notrunc)[1],
         solve_quadratic.med(param_list4_notrunc)[1],
         solve_quadratic.med(param_list5_notrunc)[1],
         51.542)
)

center_x.exp.extreme.med <- ext.df.med$Low[9]
center_y.exp.extreme.med <- ext.df.med$High[9]

# Plotting
ggplot(ext.df.med, aes(x = Low, y = High,color=Method)) +
  geom_point() +
  geom_point(x = center_x.exp.extreme.med, y = center_y.exp.extreme.med, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Temperatures where Predicted Lifetime Hits 1 Day (Posterior Median)",
       subtitle="Data Generated from Exponential Distribution",
       x = "Low",
       y = "High") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.exp.extreme.med - 12, center_x.exp.extreme.med + 12), ylim = c(center_y.exp.extreme.med - 165, center_y.exp.extreme.med + 165))

```

```{r WB.extreme.med}
solve_quadratic.med.wb <- function(f) {
  # Calculate discriminant
  a <- exp(median(unlist(lapply(f[[1]], function(matrix) matrix[, 1]))))
  b <- -(median(unlist(lapply(f[[2]], function(matrix) matrix[, 1]))))
  c <- median(unlist(lapply(f[[3]], function(matrix) matrix[, 1])))
  discriminant <- b^2 - 4 * a * (c - log(1))
  
  # Solve quadratic equation
  if (discriminant >= 0) {
    x1 <- (-b + sqrt(discriminant)) / (2 * a)
    x2 <- (-b - sqrt(discriminant)) / (2 * a)
    return(c(x1, x2))
  } else {
    warning("No real solutions for y = 1 in quadratic equation.")
    return(NA)
  }
}

ext.df.med.wb <- data.frame(
  Method=factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual WB Data, WB Model", "True Curve"), 
               levels = c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model","Individual WB Data, WB Model", "True Curve")),
  Low=c(solve_quadratic.med.wb(Weibull_param_list1)[2],
        solve_quadratic.med.wb(Weibull_param_list2)[2],
        solve_quadratic.med.wb(Weibull_param_list3)[2],
        solve_quadratic.med.wb(Weibull_param_list4)[2],
        solve_quadratic.med.wb(Weibull_param_list5)[2],
        solve_quadratic.med.wb(Weibull_param_list6)[2],
        4.192
        ),
  High=c(solve_quadratic.med.wb(Weibull_param_list1)[1],
         solve_quadratic.med.wb(Weibull_param_list2)[1],
         solve_quadratic.med.wb(Weibull_param_list3)[1],
         solve_quadratic.med.wb(Weibull_param_list4)[1],
         solve_quadratic.med.wb(Weibull_param_list5)[1],
         solve_quadratic.med.wb(Weibull_param_list6)[1],
         40.602)
)

center_x.wb.extreme.med <- ext.df.med.wb$Low[7]
center_y.wb.extreme.med <- ext.df.med.wb$High[7]

# Plotting
ggplot(ext.df.med.wb, aes(x = Low, y = High,color=Method)) +
  geom_point() +
  geom_point(x = center_x.wb.extreme.med, y = center_y.wb.extreme.med, size = 3,col="#FF61CC",shape=8) +
  labs(title = "Temperatures where Predicted Lifetime Hits 1 Day (Posterior Median)",
       subtitle="Data Generated from Weibull Distribution",
       x = "Low",
       y = "High") +
  theme_minimal()+
  coord_cartesian(xlim = c(center_x.wb.extreme.med - 1, center_x.wb.extreme.med + 1), ylim = c(center_y.wb.extreme.med - 3, center_y.wb.extreme.med + 3))

```



```{r QQPlot.Ind.Exp.Data}
ind.exp.10<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==10],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*10^2-
                               exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.17<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==17],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.21<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==21],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.25<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==25],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.32<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==32],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list1[[1]], function(matrix) matrix[, 1]))))*32^2-
                               exp(mean(unlist(lapply(param_list1[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(ind.exp.10,pch=20,xlim=c(0,80),ylim=c(0,100),
     main="QQ-Plot for Exp Data and Exp Distribution",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(ind.exp.17,pch=20,col="yellowgreen")
points(ind.exp.21,pch=20,col="darkblue")
points(ind.exp.25,pch=20,col="lightpink")
points(ind.exp.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```

```{r QQPlot.Mean.Exp.Data}
group_means.mean.exp <- tapply(data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp)  # Extract means and unlist the result
    )
mean.exp.10<-qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T==10],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*10^2-
                               exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.17<-qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T==17],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.21<-qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T==21],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.25<-qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T==25],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.32<-qqPlot(df.mean.mean.exp$trait[df.mean.mean.exp$T==32],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(param_list2[[1]], function(matrix) matrix[, 1]))))*32^2-
                               exp(mean(unlist(lapply(param_list2[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(mean.exp.10,pch=20,xlim=c(0,30),ylim=c(0,50),
     main="QQ-Plot for Mean Exp Data and Exp Distribution",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.exp.17,pch=20,col="yellowgreen")
points(mean.exp.21,pch=20,col="darkblue")
points(mean.exp.25,pch=20,col="lightpink")
points(mean.exp.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```

```{r QQPlot.Inv.Exp.Data}
inv.exp.10<-qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T==10],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.17<-qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T==17],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.21<-qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T==21],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.25<-qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T==25],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.32<-qqPlot(1/data.list[[100]]$trait[data.list[[100]]$T==32],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(inv.exp.10,pch=20,,
     main="QQ-Plot for Inverse Exp Data and Exp Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.exp.17,pch=20,col="yellowgreen")
points(inv.exp.21,pch=20,col="darkblue")
points(inv.exp.25,pch=20,col="lightpink")
points(inv.exp.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```

```{r QQPlot.Mean.Inv.Exp.Data}
group_means.mean.exp <- tapply(data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp)  # Extract means and unlist the result
    )
mean.inv.exp.10<-qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T==10],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*10^2-
                               exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.17<-qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T==17],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.21<-qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T==21],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.25<-qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T==25],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.32<-qqPlot(1/df.mean.mean.exp$trait[df.mean.mean.exp$T==32],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list4[[1]], function(matrix) matrix[, 1]))))*32^2-
                               exp(mean(unlist(lapply(param_list4[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(mean.inv.exp.10,pch=20,xlim=c(0,3000),ylim=c(0,0.75),
     main="QQ-Plot for Mean Inverse Exp Data and Exp Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.inv.exp.17,pch=20,col="yellowgreen")
points(mean.inv.exp.21,pch=20,col="darkblue")
points(mean.inv.exp.25,pch=20,col="lightpink")
points(mean.inv.exp.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```

```{r QQPlot.Inv.Mean.Exp.Data}
group_means.inv.exp <- tapply(1/data.list[[100]]$trait, data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.exp <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.exp)  # Extract means and unlist the result
    )
inv.mean.exp.10<-qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T==10],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*10^2-
                               exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.17<-qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T==17],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.21<-qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T==21],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.25<-qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T==25],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.32<-qqPlot(df.mean.inv.exp$trait[df.mean.inv.exp$T==32],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(param_list5[[1]], function(matrix) matrix[, 1]))))*32^2-
                               exp(mean(unlist(lapply(param_list5[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(inv.mean.exp.10,pch=20,xlim=c(0,5),ylim=c(0,5),
     main="QQ-Plot for Inverse Mean Exp Data and Exp Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.mean.exp.17,pch=20,col="yellowgreen")
points(inv.mean.exp.21,pch=20,col="darkblue")
points(inv.mean.exp.25,pch=20,col="lightpink")
points(inv.mean.exp.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```



```{r QQPlot.Ind.WB.Data}
ind.wb.10<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==10],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.17<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==17],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.21<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==21],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.25<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==25],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.32<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==32],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list1[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list1[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)

plot(ind.wb.10,xlim=c(0,35),ylim=c(0,35),pch=20,
       main="QQ-Plot for WB Data and Exponential Distribution",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(ind.wb.17,pch=20,col="yellowgreen")
points(ind.wb.21,pch=20,col="darkblue")
points(ind.wb.25,pch=20,col="lightpink")
points(ind.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))

```

```{r QQPlot.Mean.WB.Data}
group_means.mean.wb <- tapply(Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb)  # Extract means and unlist the result
    )
mean.wb.10<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==10],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.17<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==17],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.21<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==21],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.25<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==25],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.32<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==32],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_param_list2[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list2[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(mean.wb.10,pch=20,xlim=c(0,60),ylim=c(0,30),
     main="QQ-Plot for Mean WB Data and Exp Distribution",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.wb.17,pch=20,col="yellowgreen")
points(mean.wb.21,pch=20,col="darkblue")
points(mean.wb.25,pch=20,col="lightpink")
points(mean.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```

```{r QQPlot.Inv.WB.Data}
inv.wb.10<-qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==10],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.wb.17<-qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.21<-qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.25<-qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.32<-qqPlot(1/Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==32],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list3[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list3[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(inv.wb.10,xlim=c(0,50),ylim=c(0,3),pch=20,
       main="QQ-Plot for Inverse WB Data and Exponential Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.wb.17,pch=20,col="yellowgreen")
points(inv.wb.21,pch=20,col="darkblue")
points(inv.wb.25,pch=20,col="lightpink")
points(inv.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))

```

```{r QQPlot.Mean.Inv.WB.Data}
group_means.mean.wb <- tapply(Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb)  # Extract means and unlist the result
    )
mean.inv.wb.10<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==10],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.wb.17<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.21<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.25<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.32<-qqPlot(df.mean.mean.wb$trait[df.mean.mean.wb$T==32],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list4[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list4[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(mean.inv.wb.10,pch=20,ylim=c(0,30),xlim=c(0,8000),
       main="QQ-Plot for Mean Inverse WB Data and Exponential Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.inv.wb.17,pch=20,col="yellowgreen")
points(mean.inv.wb.21,pch=20,col="darkblue")
points(mean.inv.wb.25,pch=20,col="lightpink")
points(mean.inv.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))

```

```{r QQPlot.Inv.Mean.WB.Data}
group_means.inv.wb <- tapply(1/Weibull_data.list[[100]]$trait, Weibull_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.wb <- data.frame(
    T = c(rep(10, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(32, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.wb)  # Extract means and unlist the result
    )

inv.mean.wb.10<-qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T==10],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.wb.17<-qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.21<-qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.25<-qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.32<-qqPlot(df.mean.inv.wb$trait[df.mean.inv.wb$T==32],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_param_list5[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list5[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(inv.mean.wb.10,pch=20,xlim=c(0,1500),ylim=c(0,1),
       main="QQ-Plot for Inverse Mean WB Data and Exponential Distribution",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.mean.wb.17,pch=20,col="yellowgreen")
points(inv.mean.wb.21,pch=20,col="darkblue")
points(inv.mean.wb.25,pch=20,col="lightpink")
points(inv.mean.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))

```

```{r QQPlot.WB.Data.WB.Model}
wb.wb.10<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==10],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*10^2-
                               (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))*10+
                               mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.17<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==17],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.21<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==21],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.25<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==25],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.32<-qqPlot(Weibull_data.list[[100]]$trait[Weibull_data.list[[100]]$T==32],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_param_list6[[1]], function(matrix) matrix[, 1]))))*32^2-
                               (mean(unlist(lapply(Weibull_param_list6[[2]], function(matrix) matrix[, 1]))))*32+
                               mean(unlist(lapply(Weibull_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)

plot(wb.wb.10,xlim=c(0,35),ylim=c(0,35),pch=20,
       main="QQ-Plot for WB Data and WB Distribution",
       xlab="Quantiles of Weibull with Posterior Mean Parameters",
       ylab="Quantiles of Generated Data with True Parameters")
points(wb.wb.17,pch=20,col="yellowgreen")
points(wb.wb.21,pch=20,col="darkblue")
points(wb.wb.25,pch=20,col="lightpink")
points(wb.wb.32,pch=20,col="seagreen")
legend("topleft",legend=c("10","17","21","25","32"),
       pch=c(20,20,20,20,20),col=c("black","yellowgreen","darkblue","lightpink","seagreen"))
```



```{r RMSE.Boxplot.Exp}
xdf1$true.value<-rep(true_curve(xseq),938)
xdf2$true.value<-rep(true_curve(xseq),938)
xdf3$true.value<-rep(true_curve(xseq),938)
xdf4.2$true.value<-rep(true_curve(xseq),938)
xdf5$true.value<-rep(true_curve(xseq),938)
xdf3.NT$true.value<-rep(true_curve(xseq),938)
xdf4.NT$true.value<-rep(true_curve(xseq),938)
xdf5.NT$true.value<-rep(true_curve(xseq),938)


rmse1<-xdf1 |> group_by(point) |> summarize(rmse1=sqrt(mean((trunc.inv-true.value)^2))) |> select(rmse1)
rmse2<-xdf2 |> group_by(point) |> summarize(rmse2=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse2)
rmse3<-xdf3 |> group_by(point) |> summarize(rmse3=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3)
rmse4<-xdf4.2 |> group_by(point) |> summarize(rmse4=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4)
rmse5<-xdf5 |> group_by(point) |> summarize(rmse5=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5)
rmse3.NT<-xdf3.NT |> group_by(point) |> summarize(rmse3.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3.NT)
rmse4.NT<-xdf4.NT |> group_by(point) |> summarize(rmse4.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4.NT)
rmse5.NT<-xdf5.NT |> group_by(point) |> summarize(rmse5.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5.NT)

boxplot.df<-data.frame(
  Method=factor(c(rep("Individual Exp Data, Exp Model",250),rep("Mean Exp Data, Exp Model",250),rep("Individual Inverse Exp Data, Exp Model",250),rep("Mean Inverse Exp Data, Exp Model",250),rep("Inverse Mean Exp Data, Exp Model",250),rep("Individual Inverse Exp Data, Exp NT Model",250),rep("Mean Inverse Exp Data, Exp NT Model",250),rep("Inverse Mean Exp Data, Exp NT Model",250)),levels=rev(c("Inverse Mean Exp Data, Exp NT Model","Mean Inverse Exp Data, Exp NT Model","Individual Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp Model","Mean Inverse Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Exp Data, Exp Model","Individual Exp Data, Exp Model"))),
  RMSE=c(rmse1$rmse1,
         rmse2$rmse2,
         rmse3$rmse3,
         rmse4$rmse4,
         rmse5$rmse5,
         rmse3.NT$rmse3.NT,
         rmse4.NT$rmse4.NT,
         rmse5.NT$rmse5.NT
  ),
  Temperature=c(rep(xdf1$point,8))
)

ggplot(boxplot.df,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Exponential Distribution")
ggplot(boxplot.df,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line()+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Exponential Distribution")

```

```{r RMSE.Boxplot.WB}
xdf1_W$true.value<-rep(true_curve(xseq),938)
xdf2_W$true.value<-rep(true_curve(xseq),938)
xdf3_W$true.value<-rep(true_curve(xseq),938)
xdf4_W$true.value<-rep(true_curve(xseq),938)
xdf5_W$true.value<-rep(true_curve(xseq),938)
xdf6_W$true.value<-rep(true_curve(xseq),938)


rmse1.wb<-xdf1_W |> group_by(point) |> summarize(rmse1.wb=sqrt(mean((trunc.inv-true.value)^2))) |> select(rmse1.wb)
rmse2.wb<-xdf2_W |> group_by(point) |> summarize(rmse2.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse2.wb)
rmse3.wb<-xdf3_W |> group_by(point) |> summarize(rmse3.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3.wb)
rmse4.wb<-xdf4_W |> group_by(point) |> summarize(rmse4.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4.wb)
rmse5.wb<-xdf5_W |> group_by(point) |> summarize(rmse5.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5.wb)
rmse6.wb<-xdf6_W |> group_by(point) |> summarize(rmse6.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse6.wb)


boxplot.df.wb<-data.frame(
  Method=factor(c(rep("Individual WB Data, Exp Model",250),rep("Mean WB Data, Exp Model",250),rep("Individual Inverse WB Data, Exp Model",250),rep("Mean Inverse WB Data, Exp Model",250),rep("Inverse Mean WB Data, Exp Model",250),rep("WB Data, WB Model",250)),levels=rev(c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Mean Inverse WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean WB Data, Exp Model","Individual WB Data, Exp Model"))),
  RMSE=c(rmse1.wb$rmse1.wb,
         rmse2.wb$rmse2.wb,
         rmse3.wb$rmse3.wb,
         rmse4.wb$rmse4.wb,
         rmse5.wb$rmse5.wb,
         rmse6.wb$rmse6.wb
  ),
  Temperature=c(rep(xdf1_W$point,6))
)

ggplot(boxplot.df.wb,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution")
ggplot(boxplot.df.wb,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line()+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution")

joint.box <- rbind(boxplot.df[!(boxplot.df$Method %in% c("Individual Inverse Exp Data, Exp NT Model","Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model")),],boxplot.df.wb)
joint.box$Method <- factor(joint.box$Method, levels = rev(desired_order.compare))

ggplot(joint.box,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution")

ggplot(joint.box,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line()+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution")

```



```{r RMSE.5.Temps}
xdf1$point<-round(xdf1$point,5)
xdf2$point<-round(xdf2$point,5)
xdf3$point<-round(xdf3$point,5)
xdf4.2$point<-round(xdf4.2$point,5)
xdf5$point<-round(xdf5$point,5)

plot(xdf1[xdf1$point %in% c(10,17.02811,21.04418	,24.95984	,31.98795),] |> group_by(point) |> summarize(mean=mean(trunc.inv-true.value)),type="l")
lines(xdf2[xdf2$point %in% c(10,17.02811,21.04418	,24.95984	,31.98795),] |> group_by(point) |> summarize(mean=mean(trunc.inv-true.value)),col="red")
lines(xdf3[xdf3$point %in% c(10,17.02811,21.04418	,24.95984	,31.98795),] |> group_by(point) |> summarize(mean=mean(trunc.inv-true.value)),col="green")
lines(xdf4.2[xdf4.2$point %in% c(10,17.02811,21.04418	,24.95984	,31.98795),] |> group_by(point) |> summarize(mean=mean(trunc.inv-true.value)),col="blue")
lines(xdf5[xdf5$point %in% c(10,17.02811,21.04418	,24.95984	,31.98795),] |> group_by(point) |> summarize(mean=mean(trunc.inv-true.value)),col="purple")
```



