---
title: "Lifetime_Sim_Collective_Narrow"
author: "Piper Zimmerman"
date: "May 7, 2024"
output: html_document
---

```{r load.narrow.exp}
load("individual_exp_narrow.RData")
load("mean_exp_narrow.RData")
load("inverse_exp_narrow.RData")
load("mean_inverse_exp_narrow.RData")
load("inverse_mean_exp_narrow.RData")
load("inverse_exp_narrow_NT.RData")
load("mean_inverse_exp_narrow_NT.RData")
load("inverse_mean_exp_narrow_NT.RData")
```

```{r load.narrow.wb}
load("mean_wb_narrow.RData")
load("individual_wb_narrow.RData")
load("inverse_wb_narrow.RData")
load("mean_inverse_wb_narrow.RData")
load("inverse_mean_wb_narrow.RData")
load("individual_wb_wb_narrow.RData")
```



```{r plot.a.narrow}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.a <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[1]))
)
N_df.a$x <- factor(N_df.a$x, levels = desired_order)

N_a.plot <- ggplot(N_df.a, aes(x, Mean))+
  geom_point(col="blue") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.a, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_a.plot
```

```{r plot.b.narrow}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.b <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[1]))
)
N_df.b$x <- factor(N_df.b$x, levels = desired_order)

N_b.plot <- ggplot(N_df.b, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.b, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_b.plot
```

```{r plot.c.narrow}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.c <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[1]))
)
N_df.c$x <- factor(N_df.c$x, levels = desired_order)

N_c.plot <- ggplot(N_df.c, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.c, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_c.plot
```

```{r plot.a.narrow.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.a_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[1]))
)
N_df.a_notrunc$x <- factor(N_df.a_notrunc$x, levels = desired_order)

N_a_notrunc.plot <- ggplot(N_df.a, aes(x, Mean))+
  geom_point(col="blue") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.a, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_a_notrunc.plot
```

```{r plot.b.narrow.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.b_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[1]))
)
N_df.b_notrunc$x <- factor(N_df.b_notrunc$x, levels = desired_order)

N_b_notrunc.plot <- ggplot(N_df.b, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.b, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_b_notrunc.plot
```

```{r plot.c.narrow.nt}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
N_df.c_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[1]))
)
N_df.c_notrunc$x <- factor(N_df.c_notrunc$x, levels = desired_order)

N_c_notrunc.plot <- ggplot(N_df.c, aes(x, Mean))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.c, linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
N_c_notrunc.plot
```

```{r plot.a.narrow.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.a <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.a$x <- factor(log_N_df.a$x, levels = desired_order)

log_N_a.plot <- ggplot(log_N_df.a, aes(x, log(Mean)))+
  geom_point(col="blue") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.a), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_a.plot
```

```{r plot.b.narrow.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.b <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.b$x <- factor(log_N_df.b$x, levels = desired_order)

log_N_b.plot <- ggplot(log_N_df.b, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.b), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_b.plot
```

```{r plot.c.narrow.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.c <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.c$x <- factor(log_N_df.c$x, levels = desired_order)

log_N_c.plot <- ggplot(log_N_df.c, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.c), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_c.plot
```

```{r plot.a.narrow.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.a_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[1]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.a_notrunc$x <- factor(log_N_df.a_notrunc$x, levels = desired_order)

log_N_a_notrunc.plot <- ggplot(log_N_df.a, aes(x, log(Mean)))+
  geom_point(col="blue") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.a), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_a_notrunc.plot
```

```{r plot.b.narrow.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.b_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list3_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list4_notrunc[[2]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(N_param_list5_notrunc[[2]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.b_notrunc$x <- factor(log_N_df.b_notrunc$x, levels = desired_order)

log_N_b_notrunc.plot <- ggplot(log_N_df.b, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.b), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_b_notrunc.plot
```

```{r plot.c.narrow.nt.log}
desired_order <- c("Inverse Mean Exp Data, Exp Model", "Mean Inverse Exp Data, Exp Model",
                      "Individual Inverse Exp Data, Exp Model", "Mean Exp Data, Exp Model", "Individual Exp Data, Exp Model")
log_N_df.c_notrunc <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model","Inverse Mean Exp Data, Exp Model")),
  Mean = c((mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list3_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list4_notrunc[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(N_param_list5_notrunc[[3]], function(matrix) matrix[, 1])))[1]))
)
log_N_df.c_notrunc$x <- factor(log_N_df.c_notrunc$x, levels = desired_order)

log_N_c_notrunc.plot <- ggplot(log_N_df.c, aes(x, log(Mean)))+
  geom_point(col="blue")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.c), linetype = "dashed", color = "darkorchid")+
  theme_classic()+
  coord_flip()
log_N_c_notrunc.plot
```



```{r plot.a.narrow.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")

df.a.wb.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a.wb.n$x <- factor(df.a.wb.n$x, levels = desired_order.wb)
a.wb.plot.n <- ggplot(df.a.wb.n, aes(x, Mean))+
  geom_point(col="orange") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = true.exp.a, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
a.wb.plot.n
```

```{r plot.b.narrow.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")

df.b.wb.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))),
  upper = c(hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[2]),
  lower = c(hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[1])
)
df.b.wb.n$x <- factor(df.b.wb.n$x, levels = desired_order.wb)
b.wb.plot.n <- ggplot(df.b.wb.n, aes(x, Mean))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = true.exp.b, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
b.wb.plot.n
```

```{r plot.c.narrow.wb}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.c.wb.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c.wb.n$x <- factor(df.c.wb.n$x, levels = desired_order.wb)
c.wb.plot.n <- ggplot(df.c.wb.n, aes(x, Mean))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = true.exp.c, linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
c.wb.plot.n
```

```{r plot.a.narrow.wb.log}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.a.wb.log.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))),
           exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))),
  upper = c(exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[2]),
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[2])),
  lower = c(exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[1]),
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[1]))
)
df.a.wb.log.n$x <- factor(df.a.wb.log.n$x, levels = desired_order.wb)
a.wb.log.plot.n <- ggplot(df.a.wb.log.n, aes(x, log(Mean)))+
  geom_point(col="orange") + geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="A",x="Method")+
  geom_hline(yintercept = log(true.exp.a), linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
a.wb.log.plot.n
```

```{r plot.b.narrow.wb.log}
desired_order.wb <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.b.wb.log.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))),
           mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))),
  upper = c(hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[2],
            hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[2]),
  lower = c(hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[1],
            hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[1])
)
df.b.wb.log.n$x <- factor(df.b.wb.log.n$x, levels = desired_order.wb)
b.wb.log.plot.n <- ggplot(df.b.wb.log.n, aes(x, log(Mean)))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="B",x="Method")+
  geom_hline(yintercept = log(true.exp.b), linetype = "dashed", color = "slateblue3")+
  theme_classic()+
  coord_flip()
b.wb.log.plot.n
```

```{r plot.c.narrow.wb.log}
desired_order.wb.n <- c("WB Data, WB Model", "Inverse Mean WB Data, Exp Model", "Mean Inverse WB Data, Exp Model",
                      "Individual Inverse WB Data, Exp Model", "Mean WB Data, Exp Model", "Individual WB Data, Exp Model")
df.c.wb.log.n <- data.frame(
  x = factor(c("Individual WB Data, Exp Model","Mean WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean Inverse WB Data, Exp Model","Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
           (mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1]))))),
  upper = c((hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[2]),
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[2])),
  lower = c((hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[1]),
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[1]))
)
df.c.wb.log.n$x <- factor(df.c.wb.log.n$x, levels = desired_order.wb)
c.wb.log.plot.n <- ggplot(df.c.wb.log.n, aes(x, log(Mean)))+
  geom_point(col="orange")+ geom_linerange(aes(ymin = log(lower), ymax = log(upper)))+labs(title="C",x="Method")+
  geom_hline(yintercept = log(true.exp.c), linetype = "dashed", color = "slateblue3")+
  theme_classic()+coord_flip()
c.wb.log.plot.n
```



```{r plot.a.narrow.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.a.compare.n <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))-true.a,
           exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))-true.exp.a,
           exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))-true.exp.a),
  
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[2])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[2])-true.exp.a),
  
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list3[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1])))[1])-true.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a,
            exp(hdi(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1])))[1])-true.exp.a)
)
df.a.compare.n$x <- factor(df.a.compare.n$x, levels = desired_order.compare)
df.a.compare.n$upper<-ifelse(df.a.compare.n$upper>0.002,0.002,df.a.compare.n$upper)
a.compare.plot.n <- ggplot(df.a.compare.n, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="A",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  ylim(-0.002,0.002)+
  coord_flip()
a.compare.plot.n
```

```{r plot.b.narrow.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.b.compare.n <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c(exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))-true.b,
           (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))-true.exp.b,
           (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))-true.exp.b),
  
  upper = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[2])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b,
            (hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[2])-true.exp.b),
  
  lower = c(exp(hdi(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list3[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            exp(hdi(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1])))[1])-true.b,
            (hdi(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b,
            (hdi(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1])))[1])-true.exp.b)
)
df.b.compare.n$x <- factor(df.b.compare.n$x, levels = desired_order.compare)
df.b.compare.n$upper<-ifelse(df.b.compare.n$upper>0.16 & df.b.compare.n$lower<0.16,0.16,df.b.compare.n$upper)
b.compare.plot.n <- ggplot(df.b.compare.n, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="B",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  ylim(-0.16,0.16)+
  coord_flip()
b.compare.plot.n
```

```{r plot.c.narrow.compare}
desired_order.compare<-c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
                         "Mean Inverse WB Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                         "Individual Inverse WB Data, Exp Model","Individual Inverse Exp Data, Exp Model",
                         "Mean WB Data, Exp Model","Mean Exp Data, Exp Model","Individual WB Data, Exp Model","Individual Exp Data, Exp Model")
df.c.compare.n <- data.frame(
  x = factor(c("Individual Exp Data, Exp Model","Individual WB Data, Exp Model","Mean Exp Data, Exp Model","Mean WB Data, Exp Model",
               "Individual Inverse Exp Data, Exp Model",  "Individual Inverse WB Data, Exp Model",
               "Mean Inverse Exp Data, Exp Model", "Mean Inverse WB Data, Exp Model","Inverse Mean Exp Data, Exp Model",
               "Inverse Mean WB Data, Exp Model","WB Data, WB Model")),
  Mean = c((mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1]))))-true.c,
           (mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1]))))-true.exp.c,
           (mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1]))))-true.exp.c),
  
  upper = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[2])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c,
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[2])-true.exp.c),
  
  lower = c((hdi(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(N_param_list3[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))[1])-true.c,
            (hdi(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c,
            (hdi(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))[1])-true.exp.c)
)
df.c.compare.n$x <- factor(df.c.compare.n$x, levels = desired_order.compare)
df.c.compare.n$upper<-ifelse(df.c.compare.n$upper>0.95,0.95,df.c.compare.n$upper)
c.compare.plot.n <- ggplot(df.c.compare.n, aes(x, Mean))+
  geom_point(col="magenta") + geom_linerange(aes(ymin = lower, ymax = upper))+labs(title="C",x="Method")+
  geom_hline(yintercept = 0, linetype = "dashed", color = "springgreen3")+
  theme_classic()+
  ylim(-0.95,0.95)+
  coord_flip()
c.compare.plot.n
```



```{r QQPlot.Ind.Exp.Data.Narrow}
ind.exp.13.n<-qqPlot(N_data.list[[100]]$trait[N_data.list[[100]]$T==13],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))*13^2-
                               exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.17.n<-qqPlot(N_data.list[[100]]$trait[N_data.list[[100]]$T==17],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.21.n<-qqPlot(data.list[[100]]$trait[data.list[[100]]$T==21],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.25.n<-qqPlot(N_data.list[[100]]$trait[N_data.list[[100]]$T==25],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.exp.29.n<-qqPlot(N_data.list[[100]]$trait[N_data.list[[100]]$T==29],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list1[[1]], function(matrix) matrix[, 1]))))*29^2-
                               exp(mean(unlist(lapply(N_param_list1[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(ind.exp.13.n,pch=20,xlim=c(0,70),ylim=c(0,100),
     main="QQ-Plot for Exp Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(ind.exp.17.n,pch=20,col="chocolate1")
points(ind.exp.21.n,pch=20,col="cornflowerblue")
points(ind.exp.25.n,pch=20,col="mediumorchid4")
points(ind.exp.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","cornflowerblue","mediumorchid4","darkslategray3"))
```

```{r QQPlot.Mean.Exp.Data.Narrow}
group_means.mean.exp.n <- tapply(N_data.list[[100]]$trait, N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp.n)  # Extract means and unlist the result
    )
mean.exp.13.n<-qqPlot(df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==13],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))*13^2-
                               exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.17.n<-qqPlot(df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==17],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.21.n<-qqPlot(df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==21],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.25.n<-qqPlot(df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==25],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.exp.29.n<-qqPlot(df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==29],
       distribution="exp",
       param.list=list(rate=(exp(mean(unlist(lapply(N_param_list2[[1]], function(matrix) matrix[, 1]))))*29^2-
                               exp(mean(unlist(lapply(N_param_list2[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(mean.exp.13.n,pch=20,xlim=c(0,20),ylim=c(0,40),
     main="QQ-Plot for Mean Exp Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.exp.17.n,pch=20,col="chocolate1")
points(mean.exp.21.n,pch=20,col="dodgerblue")
points(mean.exp.25.n,pch=20,col="mediumorchid4")
points(mean.exp.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```

```{r QQPlot.Inv.Exp.Data.Narrow}
inv.exp.13.n<-qqPlot(1/N_data.list[[100]]$trait[N_data.list[[100]]$T==13],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.17.n<-qqPlot(1/N_data.list[[100]]$trait[N_data.list[[100]]$T==17],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.21.n<-qqPlot(1/N_data.list[[100]]$trait[N_data.list[[100]]$T==21],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.25.n<-qqPlot(1/N_data.list[[100]]$trait[N_data.list[[100]]$T==25],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.exp.29.n<-qqPlot(1/N_data.list[[100]]$trait[N_data.list[[100]]$T==29],
       distribution="normTrunc",
       param.list=list(mean=0.01,
                       sd=1/mean(unlist(lapply(N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(inv.exp.13.n,pch=20,ylim=c(0,12),
     main="QQ-Plot for Inverse Exp Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.exp.17.n,pch=20,col="chocolate1")
points(inv.exp.21.n,pch=20,col="dodgerblue")
points(inv.exp.25.n,pch=20,col="mediumorchid4")
points(inv.exp.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```

```{r QQPlot.Mean.Inv.Exp.Data.Narrow}
group_means.mean.exp.n <- tapply(N_data.list[[100]]$trait, N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.exp.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.exp.n)  # Extract means and unlist the result
    )
mean.inv.exp.13.n<-qqPlot(1/df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==13],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))*13^2-
                               exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.17.n<-qqPlot(1/df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==17],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.21.n<-qqPlot(1/df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==21],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.25.n<-qqPlot(1/df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==25],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.exp.29.n<-qqPlot(1/df.mean.mean.exp.n$trait[df.mean.mean.exp.n$T==29],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list4[[1]], function(matrix) matrix[, 1]))))*29^2-
                               exp(mean(unlist(lapply(N_param_list4[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(mean.inv.exp.13.n,pch=20,xlim=c(0,50),ylim=c(0,0.3),
     main="QQ-Plot for Mean Inverse Exp Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.inv.exp.17.n,pch=20,col="chocolate1")
points(mean.inv.exp.21.n,pch=20,col="dodgerblue")
points(mean.inv.exp.25.n,pch=20,col="mediumorchid4")
points(mean.inv.exp.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```

```{r QQPlot.Inv.Mean.Exp.Data.Narrow}
group_means.inv.exp.n <- tapply(1/N_data.list[[100]]$trait, N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.exp.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.exp.n)  # Extract means and unlist the result
    )
inv.mean.exp.13.n<-qqPlot(df.mean.inv.exp.n$trait[df.mean.inv.exp.n$T==13],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))*13^2-
                               exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.17.n<-qqPlot(df.mean.inv.exp.n$trait[df.mean.inv.exp.n$T==17],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))*17^2-
                               exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.21.n<-qqPlot(df.mean.inv.exp.n$trait[df.mean.inv.exp.n$T==21],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))*21^2-
                               exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.25.n<-qqPlot(df.mean.inv.exp.n$trait[df.mean.inv.exp.n$T==25],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))*25^2-
                               exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.exp.29.n<-qqPlot(df.mean.inv.exp.n$trait[df.mean.inv.exp.n$T==29],
       distribution="normTrunc",
       param.list=list(mean=(exp(mean(unlist(lapply(N_param_list5[[1]], function(matrix) matrix[, 1]))))*29^2-
                               exp(mean(unlist(lapply(N_param_list5[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)


plot(inv.mean.exp.13.n,pch=20,xlim=c(0,6.5),ylim=c(0,10),
     main="QQ-Plot for Inverse Mean Exp Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.mean.exp.17.n,pch=20,col="chocolate1")
points(inv.mean.exp.21.n,pch=20,col="dodgerblue")
points(inv.mean.exp.25.n,pch=20,col="mediumorchid4")
points(inv.mean.exp.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```



```{r QQPlot.Ind.WB.Data.Narrow}
ind.wb.13.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==13],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.17.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==17],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.21.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==21],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.25.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==25],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
ind.wb.29.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==29],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list1[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list1[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list1[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)

plot(ind.wb.13.n,xlim=c(0,90),ylim=c(0,35),pch=20,
       main="QQ-Plot for WB Data and Exponential Distribution, Narrow Interval",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(ind.wb.17.n,pch=20,col="chocolate1")
points(ind.wb.21.n,pch=20,col="dodgerblue")
points(ind.wb.25.n,pch=20,col="mediumorchid4")
points(ind.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))

```

```{r QQPlot.Mean.WB.Data.Narrow}
group_means.mean.wb.n <- tapply(Weibull_N_data.list[[100]]$trait, Weibull_N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb.n)  # Extract means and unlist the result
    )
mean.wb.13.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==13],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.17.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==17],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.21.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==21],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.25.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==25],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)
mean.wb.29.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==29],
       distribution="exp",
       param.list=list(rate=exp(exp(mean(unlist(lapply(Weibull_N_param_list2[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list2[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list2[[3]], function(matrix) matrix[, 1]))))),plot.it=FALSE)


plot(mean.wb.13.n,pch=20,xlim=c(0,60),ylim=c(0,30),
     main="QQ-Plot for Mean WB Data and Exp Distribution, Narrow Interval",
       xlab="Quantiles of Exponential with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.wb.17.n,pch=20,col="chocolate1")
points(mean.wb.21.n,pch=20,col="dodgerblue")
points(mean.wb.25.n,pch=20,col="mediumorchid4")
points(mean.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```

```{r QQPlot.Inv.WB.Data.Narrow}
inv.wb.13.n<-qqPlot(1/Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==13],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.wb.17.n<-qqPlot(1/Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.21.n<-qqPlot(1/Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.25.n<-qqPlot(1/Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.wb.29.n<-qqPlot(1/Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==29],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list3[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list3[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list3[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list3[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(inv.wb.13.n,xlim=c(0,500),ylim=c(0,0.4),pch=20,
       main="QQ-Plot for Inverse WB Data and Exponential Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.wb.17.n,pch=20,col="chocolate1")
points(inv.wb.21.n,pch=20,col="dodgerblue")
points(inv.wb.25.n,pch=20,col="mediumorchid4")
points(inv.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))

```

```{r QQPlot.Mean.Inv.WB.Data.Narrow}
group_means.mean.wb.n <- tapply(Weibull_N_data.list[[100]]$trait, Weibull_N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.mean.wb.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.mean.wb.n)  # Extract means and unlist the result
    )
mean.inv.wb.13.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==13],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
mean.inv.wb.17.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.21.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.25.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
mean.inv.wb.29.n<-qqPlot(df.mean.mean.wb.n$trait[df.mean.mean.wb.n$T==29],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list4[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list4[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list4[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list4[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(mean.inv.wb.13.n,pch=20,ylim=c(0,30),xlim=c(0,15000),
       main="QQ-Plot for Mean Inverse WB Data and Exponential Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(mean.inv.wb.17.n,pch=20,col="chocolate1")
points(mean.inv.wb.21.n,pch=20,col="dodgerblue")
points(mean.inv.wb.25.n,pch=20,col="mediumorchid4")
points(mean.inv.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))

```

```{r QQPlot.Inv.Mean.WB.Data.Narrow}
group_means.inv.wb.n <- tapply(1/Weibull_N_data.list[[100]]$trait, Weibull_N_data.list[[100]]$T, function(x) {
    split_values <- split(x, rep(1:10, each = 10))
    means <- sapply(split_values, mean)
    return(means)
    })
df.mean.inv.wb.n <- data.frame(
    T = c(rep(13, 10), rep(17, 10), rep(21, 10), rep(25, 10), rep(29, 10)), # Extract T values as numeric
    trait = unlist(group_means.inv.wb.n)  # Extract means and unlist the result
    )

inv.mean.wb.13.n<-qqPlot(df.mean.inv.wb.n$trait[df.mean.inv.wb.n$T==13],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),
       plot.it=FALSE)
inv.mean.wb.17.n<-qqPlot(df.mean.inv.wb.n$trait[df.mean.inv.wb.n$T==17],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.21.n<-qqPlot(df.mean.inv.wb.n$trait[df.mean.inv.wb.n$T==21],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.25.n<-qqPlot(df.mean.inv.wb.n$trait[df.mean.inv.wb.n$T==25],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)
inv.mean.wb.29.n<-qqPlot(df.mean.inv.wb.n$trait[df.mean.inv.wb.n$T==29],
       distribution="normTrunc",
       param.list=list(mean=exp(exp(mean(unlist(lapply(Weibull_N_param_list5[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list5[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list5[[3]], function(matrix) matrix[, 1])))),
                       sd=1/mean(unlist(lapply(Weibull_N_param_list5[[5]], function(matrix) matrix[, 1]))),
                       min=0,
                       max=Inf),plot.it=FALSE)

plot(inv.mean.wb.13.n,pch=20,xlim=c(0,4000),ylim=c(0,0.3),
       main="QQ-Plot for Inverse Mean WB Data and Exponential Distribution, Narrow Interval",
       xlab="Quantiles of Truncated Normal with Posterior Mean Rate Parameter",
       ylab="Quantiles of Generated Data with True Parameters")
points(inv.mean.wb.17.n,pch=20,col="chocolate1")
points(inv.mean.wb.21.n,pch=20,col="dodgerblue")
points(inv.mean.wb.25.n,pch=20,col="mediumorchid4")
points(inv.mean.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))

```

```{r QQPlot.WB.Data.WB.Model.Narrow}
wb.wb.13.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==13],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))*13^2-
                               (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))*13+
                               mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.17.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==17],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))*17^2-
                               (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))*17+
                               mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.21.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==21],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))*21^2-
                               (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))*21+
                               mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.25.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==25],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))*25^2-
                               (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))*25+
                               mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)
wb.wb.29.n<-qqPlot(Weibull_N_data.list[[100]]$trait[Weibull_N_data.list[[100]]$T==29],
       distribution="weibull",
       param.list=list(scale=exp(-(exp(mean(unlist(lapply(Weibull_N_param_list6[[1]], function(matrix) matrix[, 1]))))*29^2-
                               (mean(unlist(lapply(Weibull_N_param_list6[[2]], function(matrix) matrix[, 1]))))*29+
                               mean(unlist(lapply(Weibull_N_param_list6[[3]], function(matrix) matrix[, 1])))))/log(2)^(1/mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),shape=mean(unlist(lapply(Weibull_N_param_list6[[5]], function(matrix) matrix[, 1])))),plot.it=FALSE)

plot(wb.wb.13.n,xlim=c(0,35),ylim=c(0,35),pch=20,
       main="QQ-Plot for WB Data and WB Distribution, Narrow Interval",
       xlab="Quantiles of Weibull with Posterior Mean Parameters",
       ylab="Quantiles of Generated Data with True Parameters")
points(wb.wb.17.n,pch=20,col="chocolate1")
points(wb.wb.21.n,pch=20,col="dodgerblue")
points(wb.wb.25.n,pch=20,col="mediumorchid4")
points(wb.wb.29.n,pch=20,col="darkslategray3")
legend("topleft",legend=c("13","17","21","25","29"),
       pch=c(20,20,20,20,20),col=c("black","chocolate1","dodgerblue","mediumorchid4","darkslategray3"))
```



```{r RMSE.Boxplot.Narrow.Exp}
xdf1_N$true.value<-rep(true_curve(xseq),938)
xdf2_N$true.value<-rep(true_curve(xseq),938)
xdf3_N$true.value<-rep(true_curve(xseq),938)
xdf4_N$true.value<-rep(true_curve(xseq),938)
xdf5_N$true.value<-rep(true_curve(xseq),938)
xdf3_N.NT$true.value<-rep(true_curve(xseq),938)
xdf4_N.NT$true.value<-rep(true_curve(xseq),938)
xdf5_N.NT$true.value<-rep(true_curve(xseq),938)


rmse1_N<-xdf1_N |> group_by(point) |> summarize(rmse1=sqrt(mean((trunc.inv-true.value)^2))) |> select(rmse1)
rmse2_N<-xdf2_N |> group_by(point) |> summarize(rmse2=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse2)
rmse3_N<-xdf3_N |> group_by(point) |> summarize(rmse3=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3)
rmse4_N<-xdf4_N |> group_by(point) |> summarize(rmse4=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4)
rmse5_N<-xdf5_N |> group_by(point) |> summarize(rmse5=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5)
rmse3_N.NT<-xdf3_N.NT |> group_by(point) |> summarize(rmse3.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3.NT)
rmse4_N.NT<-xdf4_N.NT |> group_by(point) |> summarize(rmse4.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4.NT)
rmse5_N.NT<-xdf5_N.NT |> group_by(point) |> summarize(rmse5.NT=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5.NT)

boxplot.df_N<-data.frame(
  Method=factor(c(rep("Individual Exp Data, Exp Model",250),rep("Mean Exp Data, Exp Model",250),rep("Individual Inverse Exp Data, Exp Model",250),rep("Mean Inverse Exp Data, Exp Model",250),rep("Inverse Mean Exp Data, Exp Model",250),rep("Individual Inverse Exp Data, Exp NT Model",250),rep("Mean Inverse Exp Data, Exp NT Model",250),rep("Inverse Mean Exp Data, Exp NT Model",250)),levels=c("Individual Exp Data, Exp Model","Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp Model","Mean Inverse Exp Data, Exp Model",
                                                                                                                                                                                                                                                                                                                                                                                                      "Inverse Mean Exp Data, Exp Model","Individual Inverse Exp Data, Exp NT Model", "Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model")),
  RMSE=c(rmse1_N$rmse1,
         rmse2_N$rmse2,
         rmse3_N$rmse3,
         rmse4_N$rmse4,
         rmse5_N$rmse5,
         rmse3_N.NT$rmse3.NT,
         rmse4_N.NT$rmse4.NT,
         rmse5_N.NT$rmse5.NT
  ),
  Temperature=c(rep(xdf1_N$point,8))
)


ggplot(boxplot.df_N,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Exponential Distribution, Narrow Interval")
ggplot(boxplot.df_N,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line(aes(col=Method))+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Exponential Distribution, Narrow Interval")


```

```{r RMSE.Boxplot.Narrow.WB}
xdf1_W_N$true.value<-rep(true_curve(xseq),938)
xdf2_W_N$true.value<-rep(true_curve(xseq),938)
xdf3_W_N$true.value<-rep(true_curve(xseq),938)
xdf4_W_N$true.value<-rep(true_curve(xseq),938)
xdf5_W_N$true.value<-rep(true_curve(xseq),938)
xdf6_W_N$true.value<-rep(true_curve(xseq),938)


rmse1.wb_N<-xdf1_W_N |> group_by(point) |> summarize(rmse1.wb=sqrt(mean((trunc.inv-true.value)^2))) |> select(rmse1.wb)
rmse2.wb_N<-xdf2_W_N |> group_by(point) |> summarize(rmse2.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse2.wb)
rmse3.wb_N<-xdf3_W_N |> group_by(point) |> summarize(rmse3.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse3.wb)
rmse4.wb_N<-xdf4_W_N |> group_by(point) |> summarize(rmse4.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse4.wb)
rmse5.wb_N<-xdf5_W_N |> group_by(point) |> summarize(rmse5.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse5.wb)
rmse6.wb_N<-xdf6_W_N |> group_by(point) |> summarize(rmse6.wb=sqrt(mean((trunc.inv-true.value)^2)))|> select(rmse6.wb)


boxplot.df.wb_N<-data.frame(
  Method=factor(c(rep("Individual WB Data, Exp Model",250),rep("Mean WB Data, Exp Model",250),rep("Individual Inverse WB Data, Exp Model",250),rep("Mean Inverse WB Data, Exp Model",250),rep("Inverse Mean WB Data, Exp Model",250),rep("WB Data, WB Model",250)),levels=rev(c("WB Data, WB Model","Inverse Mean WB Data, Exp Model","Mean Inverse WB Data, Exp Model","Individual Inverse WB Data, Exp Model",
               "Mean WB Data, Exp Model","Individual WB Data, Exp Model"))),
  RMSE=c(rmse1.wb_N$rmse1.wb,
         rmse2.wb_N$rmse2.wb,
         rmse3.wb_N$rmse3.wb,
         rmse4.wb_N$rmse4.wb,
         rmse5.wb_N$rmse5.wb,
         rmse6.wb_N$rmse6.wb
  ),
  Temperature=c(rep(xdf1_W_N$point,6))
)

joint.box_N <- rbind(boxplot.df_N[!(boxplot.df_N$Method %in% c("Individual Inverse Exp Data, Exp NT Model","Mean Inverse Exp Data, Exp NT Model","Inverse Mean Exp Data, Exp NT Model")),],boxplot.df.wb_N)
joint.box_N$Method <- factor(joint.box_N$Method, levels = desired_order.compare)


ggplot(boxplot.df.wb_N,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution, Narrow Interval")
ggplot(boxplot.df.wb_N,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line()+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution, Narrow Interval")

ggplot(joint.box_N,aes(y=Method,x=RMSE,fill=Method))+
  geom_boxplot()+
  theme_classic()+
  theme(legend.position="none")+
  labs(title="Boxplot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution, Narrow Interval")
ggplot(joint.box_N,aes(y=RMSE,x=Temperature,col=Method))+
  geom_line()+
  theme_classic()+
  labs(title="Plot of RMSE Comparisons",
       subtitle="Data Generated from Weibull Distribution, Nrrow Interval")

```
